{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Coding/Self_Learningv1/components/ui/card.tsx"],"sourcesContent":["// components/ui/card.tsx\nimport * as React from \"react\"\nimport { cn } from \"@/lib/utils\"\n\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"rounded-lg border bg-card text-card-foreground shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nCard.displayName = \"Card\"\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\n    {...props}\n  />\n))\nCardHeader.displayName = \"CardHeader\"\n\nconst CardTitle = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLHeadingElement>\n>(({ className, ...props }, ref) => (\n  <h3\n    ref={ref}\n    className={cn(\n      \"text-2xl font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nCardTitle.displayName = \"CardTitle\"\n\nconst CardDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => (\n  <p\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nCardDescription.displayName = \"CardDescription\"\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex items-center p-6 pt-0\", className)}\n    {...props}\n  />\n))\nCardFooter.displayName = \"CardFooter\"\n\nexport { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent }\n"],"names":[],"mappings":"AAAA,yBAAyB;;;;;;;;;;;;;;;;AACzB;AACA;;;;AAEA,MAAM,qBAAO,mNAAgB,CAG3B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,IAAA,kHAAE,EACX,4DACA;QAED,GAAG,KAAK;;;;;;AAGb,KAAK,WAAW,GAAG;AAEnB,MAAM,2BAAa,mNAAgB,CAGjC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,IAAA,kHAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGb,WAAW,WAAW,GAAG;AAEzB,MAAM,0BAAY,mNAAgB,CAGhC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,IAAA,kHAAE,EACX,sDACA;QAED,GAAG,KAAK;;;;;;AAGb,UAAU,WAAW,GAAG;AAExB,MAAM,gCAAkB,mNAAgB,CAGtC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,IAAA,kHAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGb,gBAAgB,WAAW,GAAG;AAE9B,MAAM,4BAAc,mNAAgB,CAGlC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QAAI,KAAK;QAAK,WAAW,IAAA,kHAAE,EAAC,YAAY;QAAa,GAAG,KAAK;;;;;;AAEhE,YAAY,WAAW,GAAG;AAE1B,MAAM,2BAAa,mNAAgB,CAGjC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,IAAA,kHAAE,EAAC,8BAA8B;QAC3C,GAAG,KAAK;;;;;;AAGb,WAAW,WAAW,GAAG"}},
    {"offset": {"line": 90, "column": 0}, "map": {"version":3,"sources":["file:///C:/Coding/Self_Learningv1/components/ui/checkbox.tsx"],"sourcesContent":["// components/ui/checkbox.tsx\n\"use client\"\n\nimport * as React from \"react\"\nimport * as CheckboxPrimitive from \"@radix-ui/react-checkbox\"\nimport { Check } from \"lucide-react\"\nimport { cn } from \"@/lib/utils\"\n\nconst Checkbox = React.forwardRef<\n  React.ElementRef<typeof CheckboxPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <CheckboxPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground\",\n      className\n    )}\n    {...props}\n  >\n    <CheckboxPrimitive.Indicator\n      className={cn(\"flex items-center justify-center text-current\")}\n    >\n      <Check className=\"h-4 w-4\" />\n    </CheckboxPrimitive.Indicator>\n  </CheckboxPrimitive.Root>\n))\nCheckbox.displayName = CheckboxPrimitive.Root.displayName\n\nexport { Checkbox }\n"],"names":[],"mappings":"AAAA,6BAA6B;;;;;;AAG7B;AACA;AACA;AACA;AALA;;;;;;AAOA,MAAM,yBAAW,mNAAgB,CAG/B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC,4KAAsB;QACrB,KAAK;QACL,WAAW,IAAA,kHAAE,EACX,kTACA;QAED,GAAG,KAAK;kBAET,cAAA,8OAAC,iLAA2B;YAC1B,WAAW,IAAA,kHAAE,EAAC;sBAEd,cAAA,8OAAC,6MAAK;gBAAC,WAAU;;;;;;;;;;;;;;;;AAIvB,SAAS,WAAW,GAAG,4KAAsB,CAAC,WAAW"}},
    {"offset": {"line": 135, "column": 0}, "map": {"version":3,"sources":["file:///C:/Coding/Self_Learningv1/components/ui/select.tsx"],"sourcesContent":["// components/ui/select.tsx\n\"use client\"\n\nimport * as React from \"react\"\nimport * as SelectPrimitive from \"@radix-ui/react-select\"\nimport { Check, ChevronDown, ChevronUp } from \"lucide-react\"\nimport { cn } from \"@/lib/utils\"\n\nconst Select = SelectPrimitive.Root\n\nconst SelectGroup = SelectPrimitive.Group\n\nconst SelectValue = SelectPrimitive.Value\n\nconst SelectTrigger = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <SelectPrimitive.Icon asChild>\n      <ChevronDown className=\"h-4 w-4 opacity-50\" />\n    </SelectPrimitive.Icon>\n  </SelectPrimitive.Trigger>\n))\nSelectTrigger.displayName = SelectPrimitive.Trigger.displayName\n\nconst SelectScrollUpButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollUpButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronUp className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollUpButton>\n))\nSelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName\n\nconst SelectScrollDownButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollDownButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronDown className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollDownButton>\n))\nSelectScrollDownButton.displayName =\n  SelectPrimitive.ScrollDownButton.displayName\n\nconst SelectContent = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>\n>(({ className, children, position = \"popper\", ...props }, ref) => (\n  <SelectPrimitive.Portal>\n    <SelectPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2\",\n        position === \"popper\" &&\n          \"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1\",\n        className\n      )}\n      position={position}\n      {...props}\n    >\n      <SelectScrollUpButton />\n      <SelectPrimitive.Viewport\n        className={cn(\n          \"p-1\",\n          position === \"popper\" &&\n            \"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]\"\n        )}\n      >\n        {children}\n      </SelectPrimitive.Viewport>\n      <SelectScrollDownButton />\n    </SelectPrimitive.Content>\n  </SelectPrimitive.Portal>\n))\nSelectContent.displayName = SelectPrimitive.Content.displayName\n\nconst SelectLabel = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Label\n    ref={ref}\n    className={cn(\"py-1.5 pl-8 pr-2 text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nSelectLabel.displayName = SelectPrimitive.Label.displayName\n\nconst SelectItem = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <SelectPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </SelectPrimitive.ItemIndicator>\n    </span>\n\n    <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>\n  </SelectPrimitive.Item>\n))\nSelectItem.displayName = SelectPrimitive.Item.displayName\n\nconst SelectSeparator = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nSelectSeparator.displayName = SelectPrimitive.Separator.displayName\n\nexport {\n  Select,\n  SelectGroup,\n  SelectValue,\n  SelectTrigger,\n  SelectContent,\n  SelectLabel,\n  SelectItem,\n  SelectSeparator,\n  SelectScrollUpButton,\n  SelectScrollDownButton,\n}\n"],"names":[],"mappings":"AAAA,2BAA2B;;;;;;;;;;;;;;;;;;;;;;;;AAG3B;AACA;AACA;AAAA;AAAA;AACA;AALA;;;;;;AAOA,MAAM,SAAS,0KAAoB;AAEnC,MAAM,cAAc,2KAAqB;AAEzC,MAAM,cAAc,2KAAqB;AAEzC,MAAM,8BAAgB,mNAAgB,CAGpC,CAAC,EAAE,SAAS,EAAE,QAAQ,EAAE,GAAG,OAAO,EAAE,oBACpC,8OAAC,6KAAuB;QACtB,KAAK;QACL,WAAW,IAAA,kHAAE,EACX,mTACA;QAED,GAAG,KAAK;;YAER;0BACD,8OAAC,0KAAoB;gBAAC,OAAO;0BAC3B,cAAA,8OAAC,mOAAW;oBAAC,WAAU;;;;;;;;;;;;;;;;;AAI7B,cAAc,WAAW,GAAG,6KAAuB,CAAC,WAAW;AAE/D,MAAM,qCAAuB,mNAAgB,CAG3C,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC,oLAA8B;QAC7B,KAAK;QACL,WAAW,IAAA,kHAAE,EACX,wDACA;QAED,GAAG,KAAK;kBAET,cAAA,8OAAC,6NAAS;YAAC,WAAU;;;;;;;;;;;AAGzB,qBAAqB,WAAW,GAAG,oLAA8B,CAAC,WAAW;AAE7E,MAAM,uCAAyB,mNAAgB,CAG7C,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC,sLAAgC;QAC/B,KAAK;QACL,WAAW,IAAA,kHAAE,EACX,wDACA;QAED,GAAG,KAAK;kBAET,cAAA,8OAAC,mOAAW;YAAC,WAAU;;;;;;;;;;;AAG3B,uBAAuB,WAAW,GAChC,sLAAgC,CAAC,WAAW;AAE9C,MAAM,8BAAgB,mNAAgB,CAGpC,CAAC,EAAE,SAAS,EAAE,QAAQ,EAAE,WAAW,QAAQ,EAAE,GAAG,OAAO,EAAE,oBACzD,8OAAC,4KAAsB;kBACrB,cAAA,8OAAC,6KAAuB;YACtB,KAAK;YACL,WAAW,IAAA,kHAAE,EACX,ucACA,aAAa,YACX,mIACF;YAEF,UAAU;YACT,GAAG,KAAK;;8BAET,8OAAC;;;;;8BACD,8OAAC,8KAAwB;oBACvB,WAAW,IAAA,kHAAE,EACX,OACA,aAAa,YACX;8BAGH;;;;;;8BAEH,8OAAC;;;;;;;;;;;;;;;;AAIP,cAAc,WAAW,GAAG,6KAAuB,CAAC,WAAW;AAE/D,MAAM,4BAAc,mNAAgB,CAGlC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC,2KAAqB;QACpB,KAAK;QACL,WAAW,IAAA,kHAAE,EAAC,0CAA0C;QACvD,GAAG,KAAK;;;;;;AAGb,YAAY,WAAW,GAAG,2KAAqB,CAAC,WAAW;AAE3D,MAAM,2BAAa,mNAAgB,CAGjC,CAAC,EAAE,SAAS,EAAE,QAAQ,EAAE,GAAG,OAAO,EAAE,oBACpC,8OAAC,0KAAoB;QACnB,KAAK;QACL,WAAW,IAAA,kHAAE,EACX,6NACA;QAED,GAAG,KAAK;;0BAET,8OAAC;gBAAK,WAAU;0BACd,cAAA,8OAAC,mLAA6B;8BAC5B,cAAA,8OAAC,6MAAK;wBAAC,WAAU;;;;;;;;;;;;;;;;0BAIrB,8OAAC,8KAAwB;0BAAE;;;;;;;;;;;;AAG/B,WAAW,WAAW,GAAG,0KAAoB,CAAC,WAAW;AAEzD,MAAM,gCAAkB,mNAAgB,CAGtC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC,+KAAyB;QACxB,KAAK;QACL,WAAW,IAAA,kHAAE,EAAC,4BAA4B;QACzC,GAAG,KAAK;;;;;;AAGb,gBAAgB,WAAW,GAAG,+KAAyB,CAAC,WAAW"}},
    {"offset": {"line": 336, "column": 0}, "map": {"version":3,"sources":["file:///C:/Coding/Self_Learningv1/components/ui/alert-dialog.tsx"],"sourcesContent":["// components/ui/alert-dialog.tsx\n\"use client\"\n\nimport * as React from \"react\"\nimport * as AlertDialogPrimitive from \"@radix-ui/react-alert-dialog\"\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nconst AlertDialog = AlertDialogPrimitive.Root\n\nconst AlertDialogTrigger = AlertDialogPrimitive.Trigger\n\nconst AlertDialogPortal = AlertDialogPrimitive.Portal\n\nconst AlertDialogOverlay = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nAlertDialogOverlay.displayName = AlertDialogPrimitive.Overlay.displayName\n\nconst AlertDialogContent = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPortal>\n    <AlertDialogOverlay />\n    <AlertDialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    />\n  </AlertDialogPortal>\n))\nAlertDialogContent.displayName = AlertDialogPrimitive.Content.displayName\n\nconst AlertDialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogHeader.displayName = \"AlertDialogHeader\"\n\nconst AlertDialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogFooter.displayName = \"AlertDialogFooter\"\n\nconst AlertDialogTitle = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold\", className)}\n    {...props}\n  />\n))\nAlertDialogTitle.displayName = AlertDialogPrimitive.Title.displayName\n\nconst AlertDialogDescription = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nAlertDialogDescription.displayName =\n  AlertDialogPrimitive.Description.displayName\n\nconst AlertDialogAction = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Action>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Action>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Action\n    ref={ref}\n    className={cn(buttonVariants(), className)}\n    {...props}\n  />\n))\nAlertDialogAction.displayName = AlertDialogPrimitive.Action.displayName\n\nconst AlertDialogCancel = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Cancel>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Cancel>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Cancel\n    ref={ref}\n    className={cn(\n      buttonVariants({ variant: \"outline\" }),\n      \"mt-2 sm:mt-0\",\n      className\n    )}\n    {...props}\n  />\n))\nAlertDialogCancel.displayName = AlertDialogPrimitive.Cancel.displayName\n\nexport {\n  AlertDialog,\n  AlertDialogPortal,\n  AlertDialogOverlay,\n  AlertDialogTrigger,\n  AlertDialogContent,\n  AlertDialogHeader,\n  AlertDialogFooter,\n  AlertDialogTitle,\n  AlertDialogDescription,\n  AlertDialogAction,\n  AlertDialogCancel,\n}\n"],"names":[],"mappings":"AAAA,iCAAiC;;;;;;;;;;;;;;;;;;;;;;;;;;AAGjC;AACA;AACA;AACA;AALA;;;;;;AAOA,MAAM,cAAc,mLAAyB;AAE7C,MAAM,qBAAqB,sLAA4B;AAEvD,MAAM,oBAAoB,qLAA2B;AAErD,MAAM,mCAAqB,mNAAgB,CAGzC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC,sLAA4B;QAC3B,WAAW,IAAA,kHAAE,EACX,0JACA;QAED,GAAG,KAAK;QACT,KAAK;;;;;;AAGT,mBAAmB,WAAW,GAAG,sLAA4B,CAAC,WAAW;AAEzE,MAAM,mCAAqB,mNAAgB,CAGzC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;;0BACC,8OAAC;;;;;0BACD,8OAAC,sLAA4B;gBAC3B,KAAK;gBACL,WAAW,IAAA,kHAAE,EACX,+fACA;gBAED,GAAG,KAAK;;;;;;;;;;;;AAIf,mBAAmB,WAAW,GAAG,sLAA4B,CAAC,WAAW;AAEzE,MAAM,oBAAoB,CAAC,EACzB,SAAS,EACT,GAAG,OACkC,iBACrC,8OAAC;QACC,WAAW,IAAA,kHAAE,EACX,oDACA;QAED,GAAG,KAAK;;;;;;AAGb,kBAAkB,WAAW,GAAG;AAEhC,MAAM,oBAAoB,CAAC,EACzB,SAAS,EACT,GAAG,OACkC,iBACrC,8OAAC;QACC,WAAW,IAAA,kHAAE,EACX,iEACA;QAED,GAAG,KAAK;;;;;;AAGb,kBAAkB,WAAW,GAAG;AAEhC,MAAM,iCAAmB,mNAAgB,CAGvC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC,oLAA0B;QACzB,KAAK;QACL,WAAW,IAAA,kHAAE,EAAC,yBAAyB;QACtC,GAAG,KAAK;;;;;;AAGb,iBAAiB,WAAW,GAAG,oLAA0B,CAAC,WAAW;AAErE,MAAM,uCAAyB,mNAAgB,CAG7C,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC,0LAAgC;QAC/B,KAAK;QACL,WAAW,IAAA,kHAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGb,uBAAuB,WAAW,GAChC,0LAAgC,CAAC,WAAW;AAE9C,MAAM,kCAAoB,mNAAgB,CAGxC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC,qLAA2B;QAC1B,KAAK;QACL,WAAW,IAAA,kHAAE,EAAC,IAAA,6IAAc,KAAI;QAC/B,GAAG,KAAK;;;;;;AAGb,kBAAkB,WAAW,GAAG,qLAA2B,CAAC,WAAW;AAEvE,MAAM,kCAAoB,mNAAgB,CAGxC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC,qLAA2B;QAC1B,KAAK;QACL,WAAW,IAAA,kHAAE,EACX,IAAA,6IAAc,EAAC;YAAE,SAAS;QAAU,IACpC,gBACA;QAED,GAAG,KAAK;;;;;;AAGb,kBAAkB,WAAW,GAAG,qLAA2B,CAAC,WAAW"}},
    {"offset": {"line": 473, "column": 0}, "map": {"version":3,"sources":["file:///C:/Coding/Self_Learningv1/components/ui/input.tsx"],"sourcesContent":["// components/ui/input.tsx\nimport * as React from \"react\"\nimport { cn } from \"@/lib/utils\"\n\nexport interface InputProps\n  extends React.InputHTMLAttributes<HTMLInputElement> {}\n\nconst Input = React.forwardRef<HTMLInputElement, InputProps>(\n  ({ className, type, ...props }, ref) => {\n    return (\n      <input\n        type={type}\n        className={cn(\n          \"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nInput.displayName = \"Input\"\n\nexport { Input }\n"],"names":[],"mappings":"AAAA,0BAA0B;;;;;;AAC1B;AACA;;;;AAKA,MAAM,sBAAQ,mNAAgB,CAC5B,CAAC,EAAE,SAAS,EAAE,IAAI,EAAE,GAAG,OAAO,EAAE;IAC9B,qBACE,8OAAC;QACC,MAAM;QACN,WAAW,IAAA,kHAAE,EACX,gWACA;QAEF,KAAK;QACJ,GAAG,KAAK;;;;;;AAGf;AAEF,MAAM,WAAW,GAAG"}},
    {"offset": {"line": 502, "column": 0}, "map": {"version":3,"sources":["file:///C:/Coding/Self_Learningv1/components/ui/label.tsx"],"sourcesContent":["// components/ui/label.tsx\n\"use client\"\n\nimport * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { cn } from \"@/lib/utils\"\n\nconst labelVariants = cva(\n  \"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n)\n\nconst Label = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &\n    VariantProps<typeof labelVariants>\n>(({ className, ...props }, ref) => (\n  <LabelPrimitive.Root\n    ref={ref}\n    className={cn(labelVariants(), className)}\n    {...props}\n  />\n))\nLabel.displayName = LabelPrimitive.Root.displayName\n\nexport { Label }\n"],"names":[],"mappings":"AAAA,0BAA0B;;;;;;AAG1B;AACA;AACA;AACA;AALA;;;;;;AAOA,MAAM,gBAAgB,IAAA,uKAAG,EACvB;AAGF,MAAM,sBAAQ,mNAAgB,CAI5B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC,yKAAmB;QAClB,KAAK;QACL,WAAW,IAAA,kHAAE,EAAC,iBAAiB;QAC9B,GAAG,KAAK;;;;;;AAGb,MAAM,WAAW,GAAG,yKAAmB,CAAC,WAAW"}},
    {"offset": {"line": 534, "column": 0}, "map": {"version":3,"sources":["file:///C:/Coding/Self_Learningv1/components/ui/textarea.tsx"],"sourcesContent":["// components/ui/textarea.tsx\nimport * as React from \"react\"\nimport { cn } from \"@/lib/utils\"\n\nexport interface TextareaProps\n  extends React.TextareaHTMLAttributes<HTMLTextAreaElement> {}\n\nconst Textarea = React.forwardRef<HTMLTextAreaElement, TextareaProps>(\n  ({ className, ...props }, ref) => {\n    return (\n      <textarea\n        className={cn(\n          \"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nTextarea.displayName = \"Textarea\"\n\nexport { Textarea }\n"],"names":[],"mappings":"AAAA,6BAA6B;;;;;;AAC7B;AACA;;;;AAKA,MAAM,yBAAW,mNAAgB,CAC/B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE;IACxB,qBACE,8OAAC;QACC,WAAW,IAAA,kHAAE,EACX,wSACA;QAEF,KAAK;QACJ,GAAG,KAAK;;;;;;AAGf;AAEF,SAAS,WAAW,GAAG"}},
    {"offset": {"line": 562, "column": 0}, "map": {"version":3,"sources":["file:///C:/Coding/Self_Learningv1/components/ui/dialog.tsx"],"sourcesContent":["// components/ui/dialog.tsx\n\"use client\"\n\nimport * as React from \"react\"\nimport * as DialogPrimitive from \"@radix-ui/react-dialog\"\nimport { X } from \"lucide-react\"\nimport { cn } from \"@/lib/utils\"\n\nconst Dialog = DialogPrimitive.Root\n\nconst DialogTrigger = DialogPrimitive.Trigger\n\nconst DialogPortal = DialogPrimitive.Portal\n\nconst DialogClose = DialogPrimitive.Close\n\nconst DialogOverlay = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Overlay\n    ref={ref}\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogOverlay.displayName = DialogPrimitive.Overlay.displayName\n\nconst DialogContent = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DialogPortal>\n    <DialogOverlay />\n    <DialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <DialogPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </DialogPrimitive.Close>\n    </DialogPrimitive.Content>\n  </DialogPortal>\n))\nDialogContent.displayName = DialogPrimitive.Content.displayName\n\nconst DialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-1.5 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogHeader.displayName = \"DialogHeader\"\n\nconst DialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogFooter.displayName = \"DialogFooter\"\n\nconst DialogTitle = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogTitle.displayName = DialogPrimitive.Title.displayName\n\nconst DialogDescription = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDialogDescription.displayName = DialogPrimitive.Description.displayName\n\nexport {\n  Dialog,\n  DialogPortal,\n  DialogOverlay,\n  DialogClose,\n  DialogTrigger,\n  DialogContent,\n  DialogHeader,\n  DialogFooter,\n  DialogTitle,\n  DialogDescription,\n}\n"],"names":[],"mappings":"AAAA,2BAA2B;;;;;;;;;;;;;;;;;;;;;;;;AAG3B;AACA;AACA;AACA;AALA;;;;;;AAOA,MAAM,SAAS,0KAAoB;AAEnC,MAAM,gBAAgB,6KAAuB;AAE7C,MAAM,eAAe,4KAAsB;AAE3C,MAAM,cAAc,2KAAqB;AAEzC,MAAM,8BAAgB,mNAAgB,CAGpC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC,6KAAuB;QACtB,KAAK;QACL,WAAW,IAAA,kHAAE,EACX,0JACA;QAED,GAAG,KAAK;;;;;;AAGb,cAAc,WAAW,GAAG,6KAAuB,CAAC,WAAW;AAE/D,MAAM,8BAAgB,mNAAgB,CAGpC,CAAC,EAAE,SAAS,EAAE,QAAQ,EAAE,GAAG,OAAO,EAAE,oBACpC,8OAAC;;0BACC,8OAAC;;;;;0BACD,8OAAC,6KAAuB;gBACtB,KAAK;gBACL,WAAW,IAAA,kHAAE,EACX,+fACA;gBAED,GAAG,KAAK;;oBAER;kCACD,8OAAC,2KAAqB;wBAAC,WAAU;;0CAC/B,8OAAC,iMAAC;gCAAC,WAAU;;;;;;0CACb,8OAAC;gCAAK,WAAU;0CAAU;;;;;;;;;;;;;;;;;;;;;;;;AAKlC,cAAc,WAAW,GAAG,6KAAuB,CAAC,WAAW;AAE/D,MAAM,eAAe,CAAC,EACpB,SAAS,EACT,GAAG,OACkC,iBACrC,8OAAC;QACC,WAAW,IAAA,kHAAE,EACX,sDACA;QAED,GAAG,KAAK;;;;;;AAGb,aAAa,WAAW,GAAG;AAE3B,MAAM,eAAe,CAAC,EACpB,SAAS,EACT,GAAG,OACkC,iBACrC,8OAAC;QACC,WAAW,IAAA,kHAAE,EACX,iEACA;QAED,GAAG,KAAK;;;;;;AAGb,aAAa,WAAW,GAAG;AAE3B,MAAM,4BAAc,mNAAgB,CAGlC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC,2KAAqB;QACpB,KAAK;QACL,WAAW,IAAA,kHAAE,EACX,qDACA;QAED,GAAG,KAAK;;;;;;AAGb,YAAY,WAAW,GAAG,2KAAqB,CAAC,WAAW;AAE3D,MAAM,kCAAoB,mNAAgB,CAGxC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC,iLAA2B;QAC1B,KAAK;QACL,WAAW,IAAA,kHAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGb,kBAAkB,WAAW,GAAG,iLAA2B,CAAC,WAAW"}},
    {"offset": {"line": 703, "column": 0}, "map": {"version":3,"sources":["file:///C:/Coding/Self_Learningv1/components/questions/question-form.tsx"],"sourcesContent":["// components/questions/question-form.tsx\n\"use client\"\n\nimport { useState, useEffect } from \"react\"\nimport { supabase } from \"@/lib/supabaseClient\"\nimport { Button } from \"@/components/ui/button\"\nimport { Input } from \"@/components/ui/input\"\nimport { Label } from \"@/components/ui/label\"\nimport { Textarea } from \"@/components/ui/textarea\"\nimport { Checkbox } from \"@/components/ui/checkbox\"\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\"\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\"\nimport { Plus, X, Image, Upload } from \"lucide-react\"\nimport type { Subject, Topic, QuestionType, Question } from \"@/types/supabase\"\n\ninterface QuestionFormProps {\n  open: boolean\n  onOpenChange: (open: boolean) => void\n  onSuccess: () => void\n  question?: Question | null\n  questionTopicIds?: string[]\n}\n\ninterface Option {\n  label: string\n  text: string\n  image_url?: string | null\n}\n\nexport function QuestionForm({\n  open,\n  onOpenChange,\n  onSuccess,\n  question,\n  questionTopicIds = [],\n}: QuestionFormProps) {\n  const [subjects, setSubjects] = useState<Subject[]>([])\n  const [topics, setTopics] = useState<Topic[]>([])\n  const [questionTypes, setQuestionTypes] = useState<QuestionType[]>([])\n  \n  const [subjectId, setSubjectId] = useState(\"\")\n  const [questionTypeId, setQuestionTypeId] = useState(\"\")\n  const [selectedTopics, setSelectedTopics] = useState<string[]>([])\n  const [content, setContent] = useState(\"\")\n  const [options, setOptions] = useState<Option[]>([\n    { label: \"A\", text: \"\", image_url: null },\n    { label: \"B\", text: \"\", image_url: null },\n    { label: \"C\", text: \"\", image_url: null },\n    { label: \"D\", text: \"\", image_url: null },\n  ])\n  const [answer, setAnswer] = useState<string | string[]>(\"\")\n  const [explanation, setExplanation] = useState(\"\")\n  \n  // 題目圖片\n  const [questionImageFile, setQuestionImageFile] = useState<File | null>(null)\n  const [questionImagePreview, setQuestionImagePreview] = useState<string | null>(null)\n  \n  // 選項圖片\n  const [optionImageFiles, setOptionImageFiles] = useState<(File | null)[]>([null, null, null, null])\n  \n  const [loading, setLoading] = useState(false)\n  const [error, setError] = useState<string | null>(null)\n\n  const isEdit = !!question\n  const selectedType = questionTypes.find((t) => t.id === questionTypeId)\n\n  // 載入基礎資料\n  useEffect(() => {\n    const fetchData = async () => {\n      const { data: { user } } = await supabase.auth.getUser()\n      if (!user) return\n\n      // 取得科目\n      const { data: subjectsData } = await supabase\n        .from(\"subjects\")\n        .select(\"*\")\n        .eq(\"user_id\", user.id)\n        .order(\"title\")\n\n      if (subjectsData) setSubjects(subjectsData)\n\n      // 取得題型\n      const { data: typesData } = await supabase\n        .from(\"question_types\")\n        .select(\"*\")\n        .order(\"name\")\n\n      if (typesData) setQuestionTypes(typesData)\n    }\n\n    if (open) fetchData()\n  }, [open])\n\n  // 當科目改變時載入主題\n  useEffect(() => {\n    const fetchTopics = async () => {\n      if (!subjectId) {\n        setTopics([])\n        return\n      }\n\n      const { data: topicsData } = await supabase\n        .from(\"topics\")\n        .select(\"*\")\n        .eq(\"subject_id\", subjectId)\n        .order(\"order\")\n\n      if (topicsData) setTopics(topicsData)\n    }\n\n    fetchTopics()\n  }, [subjectId])\n\n  // 編輯模式：填入現有資料\n  useEffect(() => {\n    if (question && open) {\n      setSubjectId(question.subject_id)\n      setQuestionTypeId(question.question_type_id)\n      setContent(question.content)\n      setExplanation(question.explanation || \"\")\n      setSelectedTopics(questionTopicIds)\n      \n      // 題目圖片\n      const imgUrl = (question as any).image_url\n      setQuestionImagePreview(imgUrl || null)\n\n      if (question.options) {\n        const opts = question.options as Option[]\n        setOptions(opts)\n        setOptionImageFiles(opts.map(() => null))\n      }\n\n      if (question.answer) {\n        setAnswer(question.answer as string | string[])\n      }\n    } else if (!question && open) {\n      // 新增模式：重置表單\n      resetForm()\n    }\n  }, [question, questionTopicIds, open])\n\n  const resetForm = () => {\n    setSubjectId(\"\")\n    setQuestionTypeId(\"\")\n    setSelectedTopics([])\n    setContent(\"\")\n    setOptions([\n      { label: \"A\", text: \"\", image_url: null },\n      { label: \"B\", text: \"\", image_url: null },\n      { label: \"C\", text: \"\", image_url: null },\n      { label: \"D\", text: \"\", image_url: null },\n    ])\n    setAnswer(\"\")\n    setExplanation(\"\")\n    setQuestionImageFile(null)\n    setQuestionImagePreview(null)\n    setOptionImageFiles([null, null, null, null])\n    setError(null)\n  }\n\n  // 處理題目圖片選擇\n  const handleQuestionImageChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0]\n    if (file) {\n      if (!file.type.startsWith(\"image/\")) {\n        setError(\"請選擇圖片檔案\")\n        return\n      }\n      if (file.size > 5 * 1024 * 1024) {\n        setError(\"圖片大小不能超過 5MB\")\n        return\n      }\n      setQuestionImageFile(file)\n      setQuestionImagePreview(URL.createObjectURL(file))\n      setError(null)\n    }\n  }\n\n  // 移除題目圖片\n  const removeQuestionImage = () => {\n    setQuestionImageFile(null)\n    setQuestionImagePreview(null)\n  }\n\n  // 處理選項圖片選擇\n  const handleOptionImageChange = (index: number, e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0]\n    if (file) {\n      if (!file.type.startsWith(\"image/\")) {\n        setError(\"請選擇圖片檔案\")\n        return\n      }\n      if (file.size > 5 * 1024 * 1024) {\n        setError(\"圖片大小不能超過 5MB\")\n        return\n      }\n      \n      const newFiles = [...optionImageFiles]\n      newFiles[index] = file\n      setOptionImageFiles(newFiles)\n      \n      const newOptions = [...options]\n      newOptions[index].image_url = URL.createObjectURL(file)\n      setOptions(newOptions)\n      setError(null)\n    }\n  }\n\n  // 移除選項圖片\n  const removeOptionImage = (index: number) => {\n    const newFiles = [...optionImageFiles]\n    newFiles[index] = null\n    setOptionImageFiles(newFiles)\n    \n    const newOptions = [...options]\n    newOptions[index].image_url = null\n    setOptions(newOptions)\n  }\n\n  // 上傳圖片到 Supabase Storage\n  const uploadImage = async (file: File, userId: string): Promise<string | null> => {\n    const fileExt = file.name.split(\".\").pop()\n    const fileName = `${userId}/${Date.now()}-${Math.random().toString(36).substr(2, 9)}.${fileExt}`\n\n    const { error } = await supabase.storage\n      .from(\"questions\")\n      .upload(fileName, file)\n\n    if (error) {\n      console.error(\"上傳失敗:\", error)\n      return null\n    }\n\n    const { data } = supabase.storage\n      .from(\"questions\")\n      .getPublicUrl(fileName)\n\n    return data.publicUrl\n  }\n\n  // 新增選項\n  const addOption = () => {\n    const nextLabel = String.fromCharCode(65 + options.length)\n    setOptions([...options, { label: nextLabel, text: \"\", image_url: null }])\n    setOptionImageFiles([...optionImageFiles, null])\n  }\n\n  // 移除選項\n  const removeOption = (index: number) => {\n    if (options.length <= 2) return\n    const newOptions = options.filter((_, i) => i !== index)\n    const relabeled = newOptions.map((opt, i) => ({\n      ...opt,\n      label: String.fromCharCode(65 + i),\n    }))\n    setOptions(relabeled)\n    \n    const newFiles = optionImageFiles.filter((_, i) => i !== index)\n    setOptionImageFiles(newFiles)\n    \n    setAnswer(\"\")\n  }\n\n  // 更新選項文字\n  const updateOption = (index: number, text: string) => {\n    const newOptions = [...options]\n    newOptions[index].text = text\n    setOptions(newOptions)\n  }\n\n  // 切換主題選擇\n  const toggleTopic = (topicId: string) => {\n    setSelectedTopics((prev) =>\n      prev.includes(topicId)\n        ? prev.filter((id) => id !== topicId)\n        : [...prev, topicId]\n    )\n  }\n\n  // 提交表單\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault()\n    setError(null)\n\n    // 驗證\n    if (!subjectId) {\n      setError(\"請選擇科目\")\n      return\n    }\n    if (!questionTypeId) {\n      setError(\"請選擇題型\")\n      return\n    }\n    if (!content.trim()) {\n      setError(\"請輸入題目內容\")\n      return\n    }\n\n    // 驗證選擇題選項\n    if (selectedType?.name === \"single_choice\" || selectedType?.name === \"multiple_choice\") {\n      const validOptions = options.filter((o) => o.text.trim() || o.image_url)\n      if (validOptions.length < 2) {\n        setError(\"至少需要 2 個選項（文字或圖片）\")\n        return\n      }\n      if (!answer || (Array.isArray(answer) && answer.length === 0)) {\n        setError(\"請選擇正確答案\")\n        return\n      }\n    }\n\n    // 驗證是非題答案\n    if (selectedType?.name === \"true_false\" && answer === \"\") {\n      setError(\"請選擇正確答案\")\n      return\n    }\n\n    setLoading(true)\n\n    try {\n      const { data: { user } } = await supabase.auth.getUser()\n      if (!user) throw new Error(\"未登入\")\n\n      // 上傳題目圖片\n      let questionImageUrl = (question as any)?.image_url || null\n      if (questionImageFile) {\n        const uploadedUrl = await uploadImage(questionImageFile, user.id)\n        if (!uploadedUrl) throw new Error(\"題目圖片上傳失敗\")\n        questionImageUrl = uploadedUrl\n      } else if (!questionImagePreview) {\n        questionImageUrl = null\n      }\n\n      // 處理選項\n      let finalOptions = null\n      if (selectedType?.name === \"single_choice\" || selectedType?.name === \"multiple_choice\") {\n        const processedOptions = []\n        for (let i = 0; i < options.length; i++) {\n          const opt = options[i]\n          if (!opt.text.trim() && !opt.image_url) continue\n          \n          let optImageUrl = opt.image_url\n          \n          // 如果有新上傳的選項圖片\n          if (optionImageFiles[i]) {\n            const uploadedUrl = await uploadImage(optionImageFiles[i]!, user.id)\n            if (!uploadedUrl) throw new Error(`選項 ${opt.label} 圖片上傳失敗`)\n            optImageUrl = uploadedUrl\n          }\n          // 如果是預覽 URL（blob:），清除它\n          if (optImageUrl?.startsWith(\"blob:\")) {\n            optImageUrl = null\n          }\n          \n          processedOptions.push({\n            label: opt.label,\n            text: opt.text,\n            image_url: optImageUrl || null,\n          })\n        }\n        finalOptions = processedOptions\n      }\n\n      // 準備答案資料\n      let finalAnswer = answer\n      if (selectedType?.name === \"true_false\") {\n        finalAnswer = answer\n      }\n\n      const questionData = {\n        user_id: user.id,\n        subject_id: subjectId,\n        question_type_id: questionTypeId,\n        content: content.trim(),\n        options: finalOptions,\n        answer: finalAnswer,\n        explanation: explanation.trim() || null,\n        image_url: questionImageUrl,\n      }\n\n      if (isEdit && question) {\n        // 更新題目\n        const { error: updateError } = await supabase\n          .from(\"questions\")\n          .update(questionData)\n          .eq(\"id\", question.id)\n\n        if (updateError) throw updateError\n\n        // 更新關聯主題\n        await supabase\n          .from(\"question_topics\")\n          .delete()\n          .eq(\"question_id\", question.id)\n\n        if (selectedTopics.length > 0) {\n          const topicLinks = selectedTopics.map((topicId) => ({\n            question_id: question.id,\n            topic_id: topicId,\n          }))\n          await supabase.from(\"question_topics\").insert(topicLinks)\n        }\n      } else {\n        // 新增題目\n        const { data: newQuestion, error: insertError } = await supabase\n          .from(\"questions\")\n          .insert(questionData)\n          .select()\n          .single()\n\n        if (insertError) throw insertError\n\n        if (selectedTopics.length > 0 && newQuestion) {\n          const topicLinks = selectedTopics.map((topicId) => ({\n            question_id: newQuestion.id,\n            topic_id: topicId,\n          }))\n          await supabase.from(\"question_topics\").insert(topicLinks)\n        }\n      }\n\n      onSuccess()\n      onOpenChange(false)\n      resetForm()\n    } catch (err) {\n      setError(err instanceof Error ? err.message : \"操作失敗\")\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  return (\n    <Dialog open={open} onOpenChange={onOpenChange}>\n      <DialogContent className=\"sm:max-w-[600px] max-h-[90vh] overflow-y-auto\">\n        <form onSubmit={handleSubmit}>\n          <DialogHeader>\n            <DialogTitle>{isEdit ? \"編輯題目\" : \"新增題目\"}</DialogTitle>\n            <DialogDescription>\n              {isEdit ? \"修改題目內容\" : \"建立新的練習題目\"}\n            </DialogDescription>\n          </DialogHeader>\n\n          <div className=\"grid gap-4 py-4\">\n            {error && (\n              <div className=\"p-3 text-sm text-red-600 bg-red-50 rounded-md\">\n                {error}\n              </div>\n            )}\n\n            {/* 科目選擇 */}\n            <div className=\"space-y-2\">\n              <Label>科目 *</Label>\n              <Select value={subjectId} onValueChange={setSubjectId}>\n                <SelectTrigger>\n                  <SelectValue placeholder=\"選擇科目\" />\n                </SelectTrigger>\n                <SelectContent>\n                  {subjects.map((subject) => (\n                    <SelectItem key={subject.id} value={subject.id}>\n                      {subject.title}\n                    </SelectItem>\n                  ))}\n                </SelectContent>\n              </Select>\n            </div>\n\n            {/* 題型選擇 */}\n            <div className=\"space-y-2\">\n              <Label>題型 *</Label>\n              <Select value={questionTypeId} onValueChange={setQuestionTypeId}>\n                <SelectTrigger>\n                  <SelectValue placeholder=\"選擇題型\" />\n                </SelectTrigger>\n                <SelectContent>\n                  {questionTypes.map((type) => (\n                    <SelectItem key={type.id} value={type.id}>\n                      {type.label}\n                    </SelectItem>\n                  ))}\n                </SelectContent>\n              </Select>\n            </div>\n\n            {/* 關聯主題 */}\n            {topics.length > 0 && (\n              <div className=\"space-y-2\">\n                <Label>關聯主題（選填）</Label>\n                <div className=\"border rounded-md p-3 max-h-32 overflow-y-auto space-y-2\">\n                  {topics.map((topic) => (\n                    <div key={topic.id} className=\"flex items-center space-x-2\">\n                      <Checkbox\n                        id={topic.id}\n                        checked={selectedTopics.includes(topic.id)}\n                        onCheckedChange={() => toggleTopic(topic.id)}\n                      />\n                      <label\n                        htmlFor={topic.id}\n                        className=\"text-sm cursor-pointer\"\n                      >\n                        {topic.title}\n                      </label>\n                    </div>\n                  ))}\n                </div>\n              </div>\n            )}\n\n            {/* 題目內容 */}\n            <div className=\"space-y-2\">\n              <Label>題目內容 *</Label>\n              <Textarea\n                placeholder=\"輸入題目內容...\"\n                value={content}\n                onChange={(e) => setContent(e.target.value)}\n                rows={3}\n              />\n            </div>\n\n            {/* 題目圖片 */}\n            <div className=\"space-y-2\">\n              <Label>題目圖片（選填）</Label>\n              {questionImagePreview ? (\n                <div className=\"relative inline-block\">\n                  <img\n                    src={questionImagePreview}\n                    alt=\"題目圖片預覽\"\n                    className=\"max-h-40 rounded-lg border object-contain\"\n                  />\n                  <Button\n                    type=\"button\"\n                    variant=\"destructive\"\n                    size=\"icon\"\n                    className=\"absolute -top-2 -right-2 h-6 w-6\"\n                    onClick={removeQuestionImage}\n                  >\n                    <X className=\"h-3 w-3\" />\n                  </Button>\n                </div>\n              ) : (\n                <label className=\"flex items-center justify-center w-full h-24 border-2 border-dashed rounded-lg cursor-pointer hover:bg-gray-50 transition-colors\">\n                  <div className=\"flex items-center gap-2 text-gray-500\">\n                    <Upload className=\"w-5 h-5\" />\n                    <span className=\"text-sm\">上傳題目圖片</span>\n                  </div>\n                  <input\n                    type=\"file\"\n                    className=\"hidden\"\n                    accept=\"image/*\"\n                    onChange={handleQuestionImageChange}\n                  />\n                </label>\n              )}\n            </div>\n\n            {/* 是非題答案 */}\n            {selectedType?.name === \"true_false\" && (\n              <div className=\"space-y-2\">\n                <Label>正確答案 *</Label>\n                <div className=\"flex gap-4\">\n                  <label className=\"flex items-center gap-2 cursor-pointer\">\n                    <input\n                      type=\"radio\"\n                      name=\"trueFalse\"\n                      value=\"true\"\n                      checked={answer === \"true\"}\n                      onChange={(e) => setAnswer(e.target.value)}\n                      className=\"w-4 h-4\"\n                    />\n                    <span>是 (O)</span>\n                  </label>\n                  <label className=\"flex items-center gap-2 cursor-pointer\">\n                    <input\n                      type=\"radio\"\n                      name=\"trueFalse\"\n                      value=\"false\"\n                      checked={answer === \"false\"}\n                      onChange={(e) => setAnswer(e.target.value)}\n                      className=\"w-4 h-4\"\n                    />\n                    <span>非 (X)</span>\n                  </label>\n                </div>\n              </div>\n            )}\n\n            {/* 選擇題選項 */}\n            {(selectedType?.name === \"single_choice\" ||\n              selectedType?.name === \"multiple_choice\") && (\n              <div className=\"space-y-2\">\n                <div className=\"flex items-center justify-between\">\n                  <Label>選項 *</Label>\n                  <Button\n                    type=\"button\"\n                    variant=\"outline\"\n                    size=\"sm\"\n                    onClick={addOption}\n                  >\n                    <Plus className=\"w-4 h-4 mr-1\" />\n                    新增選項\n                  </Button>\n                </div>\n                <div className=\"space-y-3\">\n                  {options.map((option, index) => (\n                    <div key={index} className=\"p-3 border rounded-lg space-y-2\">\n                      <div className=\"flex items-center gap-2\">\n                        {selectedType?.name === \"single_choice\" ? (\n                          <input\n                            type=\"radio\"\n                            name=\"answer\"\n                            value={option.label}\n                            checked={answer === option.label}\n                            onChange={(e) => setAnswer(e.target.value)}\n                            className=\"w-4 h-4\"\n                          />\n                        ) : (\n                          <Checkbox\n                            checked={(answer as string[])?.includes(option.label)}\n                            onCheckedChange={(checked) => {\n                              const current = (answer as string[]) || []\n                              if (checked) {\n                                setAnswer([...current, option.label])\n                              } else {\n                                setAnswer(current.filter((a) => a !== option.label))\n                              }\n                            }}\n                          />\n                        )}\n                        <span className=\"w-6 text-center font-medium\">\n                          {option.label}.\n                        </span>\n                        <Input\n                          placeholder={`選項 ${option.label} 文字`}\n                          value={option.text}\n                          onChange={(e) => updateOption(index, e.target.value)}\n                          className=\"flex-1\"\n                        />\n                        {options.length > 2 && (\n                          <Button\n                            type=\"button\"\n                            variant=\"ghost\"\n                            size=\"icon\"\n                            onClick={() => removeOption(index)}\n                            className=\"h-8 w-8 text-gray-400 hover:text-red-500\"\n                          >\n                            <X className=\"w-4 h-4\" />\n                          </Button>\n                        )}\n                      </div>\n                      \n                      {/* 選項圖片 */}\n                      <div className=\"ml-8\">\n                        {option.image_url ? (\n                          <div className=\"relative inline-block\">\n                            <img\n                              src={option.image_url}\n                              alt={`選項 ${option.label} 圖片`}\n                              className=\"max-h-24 rounded border object-contain\"\n                            />\n                            <Button\n                              type=\"button\"\n                              variant=\"destructive\"\n                              size=\"icon\"\n                              className=\"absolute -top-2 -right-2 h-5 w-5\"\n                              onClick={() => removeOptionImage(index)}\n                            >\n                              <X className=\"h-3 w-3\" />\n                            </Button>\n                          </div>\n                        ) : (\n                          <label className=\"inline-flex items-center gap-1 px-3 py-1.5 border border-dashed rounded cursor-pointer hover:bg-gray-50 text-sm text-gray-500\">\n                            <Image className=\"w-4 h-4\" />\n                            <span>加入圖片</span>\n                            <input\n                              type=\"file\"\n                              className=\"hidden\"\n                              accept=\"image/*\"\n                              onChange={(e) => handleOptionImageChange(index, e)}\n                            />\n                          </label>\n                        )}\n                      </div>\n                    </div>\n                  ))}\n                </div>\n                <p className=\"text-xs text-gray-500\">\n                  {selectedType?.name === \"single_choice\"\n                    ? \"點選選項前的圓圈設定正確答案\"\n                    : \"勾選所有正確答案\"}\n                </p>\n              </div>\n            )}\n\n            {/* 填充題答案 */}\n            {selectedType?.name === \"fill_in_blank\" && (\n              <div className=\"space-y-2\">\n                <Label>正確答案</Label>\n                <Input\n                  placeholder=\"輸入正確答案（多個答案用逗號分隔）\"\n                  value={Array.isArray(answer) ? answer.join(\", \") : answer}\n                  onChange={(e) => setAnswer(e.target.value)}\n                />\n                <p className=\"text-xs text-gray-500\">\n                  多個答案請用逗號分隔，例如：答案1, 答案2\n                </p>\n              </div>\n            )}\n\n            {/* 問答題參考答案 */}\n            {selectedType?.name === \"essay\" && (\n              <div className=\"space-y-2\">\n                <Label>參考答案（選填）</Label>\n                <Textarea\n                  placeholder=\"輸入參考答案...\"\n                  value={typeof answer === \"string\" ? answer : \"\"}\n                  onChange={(e) => setAnswer(e.target.value)}\n                  rows={3}\n                />\n              </div>\n            )}\n\n            {/* 解析 */}\n            <div className=\"space-y-2\">\n              <Label>解析說明（選填）</Label>\n              <Textarea\n                placeholder=\"輸入解析說明...\"\n                value={explanation}\n                onChange={(e) => setExplanation(e.target.value)}\n                rows={2}\n              />\n            </div>\n          </div>\n\n          <DialogFooter>\n            <Button\n              type=\"button\"\n              variant=\"outline\"\n              onClick={() => onOpenChange(false)}\n              disabled={loading}\n            >\n              取消\n            </Button>\n            <Button\n              type=\"submit\"\n              className=\"bg-blue-600 hover:bg-blue-700\"\n              disabled={loading}\n            >\n              {loading ? \"處理中...\" : isEdit ? \"儲存\" : \"建立\"}\n            </Button>\n          </DialogFooter>\n        </form>\n      </DialogContent>\n    </Dialog>\n  )\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1875, "column": 0}, "map": {"version":3,"sources":["file:///C:/Coding/Self_Learningv1/components/questions/question-import.tsx"],"sourcesContent":["// components/questions/question-import.tsx\n\"use client\"\n\nimport { useState, useRef } from \"react\"\nimport { supabase } from \"@/lib/supabaseClient\"\nimport { Button } from \"@/components/ui/button\"\nimport { Label } from \"@/components/ui/label\"\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\"\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\"\nimport { Upload, FileText, Download, CheckCircle, XCircle, AlertCircle } from \"lucide-react\"\nimport type { Subject, QuestionType } from \"@/types/supabase\"\n\ninterface QuestionImportProps {\n  open: boolean\n  onOpenChange: (open: boolean) => void\n  onSuccess: () => void\n  subjects: Subject[]\n  questionTypes: QuestionType[]\n}\n\ninterface ParsedQuestion {\n  type: string\n  content: string\n  optionA: string\n  optionB: string\n  optionC: string\n  optionD: string\n  answer: string\n  explanation: string\n  valid: boolean\n  error?: string\n}\n\n// 題型對應表\nconst typeMap: Record<string, string> = {\n  \"是非題\": \"true_false\",\n  \"單選題\": \"single_choice\",\n  \"複選題\": \"multiple_choice\",\n  \"填充題\": \"fill_in_blank\",\n  \"問答題\": \"essay\",\n}\n\nexport function QuestionImport({\n  open,\n  onOpenChange,\n  onSuccess,\n  subjects,\n  questionTypes,\n}: QuestionImportProps) {\n  const fileInputRef = useRef<HTMLInputElement>(null)\n  const [subjectId, setSubjectId] = useState(\"\")\n  const [file, setFile] = useState<File | null>(null)\n  const [parsedQuestions, setParsedQuestions] = useState<ParsedQuestion[]>([])\n  const [importing, setImporting] = useState(false)\n  const [error, setError] = useState<string | null>(null)\n  const [result, setResult] = useState<{ success: number; failed: number } | null>(null)\n\n  // 重置狀態\n  const resetState = () => {\n    setSubjectId(\"\")\n    setFile(null)\n    setParsedQuestions([])\n    setError(null)\n    setResult(null)\n    if (fileInputRef.current) {\n      fileInputRef.current.value = \"\"\n    }\n  }\n\n  // 關閉對話框\n  const handleClose = () => {\n    resetState()\n    onOpenChange(false)\n  }\n\n  // 下載範本\n  const downloadTemplate = () => {\n    const template = `題型,題目內容,選項A,選項B,選項C,選項D,正確答案,解析\n是非題,地球是太陽系中最大的行星,,,,,X,木星才是最大的行星\n單選題,台灣最高的山是？,玉山,阿里山,雪山,合歡山,A,玉山海拔3952公尺\n複選題,下列哪些是哺乳類動物？,鯨魚,鯊魚,海豚,海龜,AC,鯨魚和海豚是哺乳類\n填充題,水的化學式是____,,,,,H2O,\n問答題,請說明光合作用的過程,,,,,植物利用陽光將二氧化碳和水轉換成葡萄糖和氧氣,`\n\n    const blob = new Blob([\"\\uFEFF\" + template], { type: \"text/csv;charset=utf-8\" })\n    const url = URL.createObjectURL(blob)\n    const a = document.createElement(\"a\")\n    a.href = url\n    a.download = \"題目匯入範本.csv\"\n    a.click()\n    URL.revokeObjectURL(url)\n  }\n\n  // 解析 CSV\n  const parseCSV = (text: string): ParsedQuestion[] => {\n    const lines = text.split(\"\\n\").filter((line) => line.trim())\n    if (lines.length < 2) return []\n\n    // 跳過標題行\n    const dataLines = lines.slice(1)\n\n    return dataLines.map((line) => {\n      // 處理 CSV 欄位（考慮逗號在引號內的情況）\n      const fields = parseCSVLine(line)\n\n      const [type, content, optionA, optionB, optionC, optionD, answer, explanation] = fields\n\n      const question: ParsedQuestion = {\n        type: type?.trim() || \"\",\n        content: content?.trim() || \"\",\n        optionA: optionA?.trim() || \"\",\n        optionB: optionB?.trim() || \"\",\n        optionC: optionC?.trim() || \"\",\n        optionD: optionD?.trim() || \"\",\n        answer: answer?.trim() || \"\",\n        explanation: explanation?.trim() || \"\",\n        valid: true,\n      }\n\n      // 驗證\n      if (!question.type) {\n        question.valid = false\n        question.error = \"缺少題型\"\n      } else if (!typeMap[question.type]) {\n        question.valid = false\n        question.error = `不支援的題型：${question.type}`\n      } else if (!question.content) {\n        question.valid = false\n        question.error = \"缺少題目內容\"\n      } else if (question.type === \"是非題\" && ![\"O\", \"X\"].includes(question.answer.toUpperCase())) {\n        question.valid = false\n        question.error = \"是非題答案必須是 O 或 X\"\n      } else if (question.type === \"單選題\" && ![\"A\", \"B\", \"C\", \"D\"].includes(question.answer.toUpperCase())) {\n        question.valid = false\n        question.error = \"單選題答案必須是 A、B、C 或 D\"\n      } else if (question.type === \"複選題\" && !/^[A-D]+$/.test(question.answer.toUpperCase())) {\n        question.valid = false\n        question.error = \"複選題答案必須是 A、B、C、D 的組合\"\n      }\n\n      return question\n    })\n  }\n\n  // 解析單行 CSV（處理引號內的逗號）\n  const parseCSVLine = (line: string): string[] => {\n    const result: string[] = []\n    let current = \"\"\n    let inQuotes = false\n\n    for (let i = 0; i < line.length; i++) {\n      const char = line[i]\n\n      if (char === '\"') {\n        inQuotes = !inQuotes\n      } else if (char === \",\" && !inQuotes) {\n        result.push(current)\n        current = \"\"\n      } else {\n        current += char\n      }\n    }\n    result.push(current)\n\n    return result.map((s) => s.replace(/^\"|\"$/g, \"\"))\n  }\n\n  // 處理檔案選擇\n  const handleFileChange = async (e: React.ChangeEvent<HTMLInputElement>) => {\n    const selectedFile = e.target.files?.[0]\n    if (!selectedFile) return\n\n    if (!selectedFile.name.endsWith(\".csv\")) {\n      setError(\"請選擇 CSV 檔案\")\n      return\n    }\n\n    setFile(selectedFile)\n    setError(null)\n    setResult(null)\n\n    try {\n      const text = await selectedFile.text()\n      const questions = parseCSV(text)\n      setParsedQuestions(questions)\n\n      if (questions.length === 0) {\n        setError(\"檔案中沒有找到題目資料\")\n      }\n    } catch (err) {\n      setError(\"檔案讀取失敗\")\n    }\n  }\n\n  // 執行匯入\n  const handleImport = async () => {\n    if (!subjectId) {\n      setError(\"請選擇科目\")\n      return\n    }\n\n    const validQuestions = parsedQuestions.filter((q) => q.valid)\n    if (validQuestions.length === 0) {\n      setError(\"沒有可匯入的有效題目\")\n      return\n    }\n\n    setImporting(true)\n    setError(null)\n\n    try {\n      const { data: { user } } = await supabase.auth.getUser()\n      if (!user) throw new Error(\"未登入\")\n\n      let successCount = 0\n      let failedCount = 0\n\n      for (const q of validQuestions) {\n        try {\n          const typeName = typeMap[q.type]\n          const questionType = questionTypes.find((t) => t.name === typeName)\n          if (!questionType) {\n            failedCount++\n            continue\n          }\n\n          // 準備選項\n          let options = null\n          if (typeName === \"single_choice\" || typeName === \"multiple_choice\") {\n            options = []\n            if (q.optionA) options.push({ label: \"A\", text: q.optionA, image_url: null })\n            if (q.optionB) options.push({ label: \"B\", text: q.optionB, image_url: null })\n            if (q.optionC) options.push({ label: \"C\", text: q.optionC, image_url: null })\n            if (q.optionD) options.push({ label: \"D\", text: q.optionD, image_url: null })\n          }\n\n          // 準備答案\n          let answer: string | string[] = q.answer\n          if (typeName === \"true_false\") {\n            answer = q.answer.toUpperCase() === \"O\" ? \"true\" : \"false\"\n          } else if (typeName === \"single_choice\") {\n            answer = q.answer.toUpperCase()\n          } else if (typeName === \"multiple_choice\") {\n            answer = q.answer.toUpperCase().split(\"\")\n          }\n\n          const { error: insertError } = await supabase.from(\"questions\").insert({\n            user_id: user.id,\n            subject_id: subjectId,\n            question_type_id: questionType.id,\n            content: q.content,\n            options,\n            answer,\n            explanation: q.explanation || null,\n          })\n\n          if (insertError) {\n            failedCount++\n          } else {\n            successCount++\n          }\n        } catch {\n          failedCount++\n        }\n      }\n\n      setResult({ success: successCount, failed: failedCount })\n\n      if (successCount > 0) {\n        onSuccess()\n      }\n    } catch (err) {\n      setError(err instanceof Error ? err.message : \"匯入失敗\")\n    } finally {\n      setImporting(false)\n    }\n  }\n\n  const validCount = parsedQuestions.filter((q) => q.valid).length\n  const invalidCount = parsedQuestions.filter((q) => !q.valid).length\n\n  return (\n    <Dialog open={open} onOpenChange={handleClose}>\n      <DialogContent className=\"sm:max-w-[600px] max-h-[90vh] overflow-y-auto\">\n        <DialogHeader>\n          <DialogTitle>批次匯入題目</DialogTitle>\n          <DialogDescription>\n            上傳 CSV 檔案批次新增題目\n          </DialogDescription>\n        </DialogHeader>\n\n        <div className=\"grid gap-4 py-4\">\n          {/* 下載範本 */}\n          <div className=\"flex items-center justify-between p-3 bg-blue-50 rounded-lg\">\n            <div className=\"flex items-center gap-2 text-blue-700\">\n              <FileText className=\"w-5 h-5\" />\n              <span className=\"text-sm\">下載 CSV 範本檔案</span>\n            </div>\n            <Button\n              type=\"button\"\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={downloadTemplate}\n            >\n              <Download className=\"w-4 h-4 mr-1\" />\n              下載範本\n            </Button>\n          </div>\n\n          {/* 科目選擇 */}\n          <div className=\"space-y-2\">\n            <Label>匯入到科目 *</Label>\n            <Select value={subjectId} onValueChange={setSubjectId}>\n              <SelectTrigger>\n                <SelectValue placeholder=\"選擇科目\" />\n              </SelectTrigger>\n              <SelectContent>\n                {subjects.map((subject) => (\n                  <SelectItem key={subject.id} value={subject.id}>\n                    {subject.title}\n                  </SelectItem>\n                ))}\n              </SelectContent>\n            </Select>\n          </div>\n\n          {/* 檔案上傳 */}\n          <div className=\"space-y-2\">\n            <Label>選擇 CSV 檔案 *</Label>\n            <label className=\"flex flex-col items-center justify-center w-full h-32 border-2 border-dashed rounded-lg cursor-pointer hover:bg-gray-50 transition-colors\">\n              <div className=\"flex flex-col items-center justify-center pt-5 pb-6\">\n                <Upload className=\"w-8 h-8 text-gray-400 mb-2\" />\n                {file ? (\n                  <p className=\"text-sm text-gray-700 font-medium\">{file.name}</p>\n                ) : (\n                  <>\n                    <p className=\"text-sm text-gray-500\">點擊選擇 CSV 檔案</p>\n                    <p className=\"text-xs text-gray-400 mt-1\">支援 UTF-8 編碼</p>\n                  </>\n                )}\n              </div>\n              <input\n                ref={fileInputRef}\n                type=\"file\"\n                className=\"hidden\"\n                accept=\".csv\"\n                onChange={handleFileChange}\n              />\n            </label>\n          </div>\n\n          {/* 錯誤訊息 */}\n          {error && (\n            <div className=\"p-3 text-sm text-red-600 bg-red-50 rounded-md flex items-center gap-2\">\n              <AlertCircle className=\"w-4 h-4\" />\n              {error}\n            </div>\n          )}\n\n          {/* 匯入結果 */}\n          {result && (\n            <div className=\"p-3 bg-green-50 rounded-md\">\n              <p className=\"text-sm text-green-700\">\n                匯入完成：成功 {result.success} 題\n                {result.failed > 0 && `，失敗 ${result.failed} 題`}\n              </p>\n            </div>\n          )}\n\n          {/* 預覽 */}\n          {parsedQuestions.length > 0 && !result && (\n            <div className=\"space-y-2\">\n              <div className=\"flex items-center justify-between\">\n                <Label>預覽（共 {parsedQuestions.length} 題）</Label>\n                <div className=\"flex items-center gap-3 text-sm\">\n                  <span className=\"flex items-center gap-1 text-green-600\">\n                    <CheckCircle className=\"w-4 h-4\" />\n                    有效 {validCount}\n                  </span>\n                  {invalidCount > 0 && (\n                    <span className=\"flex items-center gap-1 text-red-600\">\n                      <XCircle className=\"w-4 h-4\" />\n                      無效 {invalidCount}\n                    </span>\n                  )}\n                </div>\n              </div>\n              <div className=\"border rounded-lg max-h-60 overflow-y-auto\">\n                <table className=\"w-full text-sm\">\n                  <thead className=\"bg-gray-50 sticky top-0\">\n                    <tr>\n                      <th className=\"px-3 py-2 text-left font-medium text-gray-600\">狀態</th>\n                      <th className=\"px-3 py-2 text-left font-medium text-gray-600\">題型</th>\n                      <th className=\"px-3 py-2 text-left font-medium text-gray-600\">題目</th>\n                      <th className=\"px-3 py-2 text-left font-medium text-gray-600\">答案</th>\n                    </tr>\n                  </thead>\n                  <tbody className=\"divide-y\">\n                    {parsedQuestions.map((q, index) => (\n                      <tr key={index} className={q.valid ? \"\" : \"bg-red-50\"}>\n                        <td className=\"px-3 py-2\">\n                          {q.valid ? (\n                            <CheckCircle className=\"w-4 h-4 text-green-500\" />\n                          ) : (\n                            <span className=\"text-xs text-red-600\">{q.error}</span>\n                          )}\n                        </td>\n                        <td className=\"px-3 py-2 whitespace-nowrap\">{q.type}</td>\n                        <td className=\"px-3 py-2\">\n                          <span className=\"line-clamp-1\">{q.content}</span>\n                        </td>\n                        <td className=\"px-3 py-2 whitespace-nowrap\">{q.answer}</td>\n                      </tr>\n                    ))}\n                  </tbody>\n                </table>\n              </div>\n            </div>\n          )}\n        </div>\n\n        <DialogFooter>\n          <Button\n            type=\"button\"\n            variant=\"outline\"\n            onClick={handleClose}\n            disabled={importing}\n          >\n            {result ? \"關閉\" : \"取消\"}\n          </Button>\n          {!result && (\n            <Button\n              type=\"button\"\n              className=\"bg-blue-600 hover:bg-blue-700\"\n              onClick={handleImport}\n              disabled={importing || validCount === 0 || !subjectId}\n            >\n              {importing ? \"匯入中...\" : `匯入 ${validCount} 題`}\n            </Button>\n          )}\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  )\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2650, "column": 0}, "map": {"version":3,"sources":["file:///C:/Coding/Self_Learningv1/components/questions/exam-export.tsx"],"sourcesContent":["// components/questions/exam-export.tsx\n\"use client\"\n\nimport { useState, useEffect, useRef } from \"react\"\nimport { Button } from \"@/components/ui/button\"\nimport { Input } from \"@/components/ui/input\"\nimport { Label } from \"@/components/ui/label\"\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\"\nimport { ChevronDown, ChevronUp, FileText } from \"lucide-react\"\nimport type { Question, QuestionType } from \"@/types/supabase\"\n\ninterface ExamExportProps {\n  open: boolean\n  onOpenChange: (open: boolean) => void\n  selectedQuestions: Question[]\n  questionTypes: QuestionType[]\n}\n\ninterface QuestionScore {\n  questionId: string\n  score: number\n}\n\ninterface TypeScoreConfig {\n  typeId: string\n  typeName: string\n  typeLabel: string\n  defaultScore: number\n  count: number\n}\n\nexport function ExamExport({\n  open,\n  onOpenChange,\n  selectedQuestions,\n  questionTypes,\n}: ExamExportProps) {\n  const [examTitle, setExamTitle] = useState(\"測驗卷\")\n  const [includeAnswer, setIncludeAnswer] = useState(false)\n  const [typeScores, setTypeScores] = useState<TypeScoreConfig[]>([])\n  const [questionScores, setQuestionScores] = useState<QuestionScore[]>([])\n  const [showDetails, setShowDetails] = useState(false)\n  const [generating, setGenerating] = useState(false)\n  const printRef = useRef<HTMLDivElement>(null)\n\n  // 初始化題型分數設定\n  useEffect(() => {\n    if (open && selectedQuestions.length > 0) {\n      // 統計各題型的題目數量\n      const typeCounts: Record<string, number> = {}\n      selectedQuestions.forEach((q) => {\n        typeCounts[q.question_type_id] = (typeCounts[q.question_type_id] || 0) + 1\n      })\n\n      // 建立題型分數設定\n      const configs: TypeScoreConfig[] = []\n      Object.entries(typeCounts).forEach(([typeId, count]) => {\n        const type = questionTypes.find((t) => t.id === typeId)\n        if (type) {\n          // 預設分數\n          let defaultScore = 2\n          if (type.name === \"essay\") defaultScore = 10\n          else if (type.name === \"fill_in_blank\") defaultScore = 5\n          else if (type.name === \"multiple_choice\") defaultScore = 3\n\n          configs.push({\n            typeId,\n            typeName: type.name,\n            typeLabel: type.label,\n            defaultScore,\n            count,\n          })\n        }\n      })\n\n      setTypeScores(configs)\n\n      // 初始化每題分數\n      const scores = selectedQuestions.map((q) => {\n        const config = configs.find((c) => c.typeId === q.question_type_id)\n        return {\n          questionId: q.id,\n          score: config?.defaultScore || 2,\n        }\n      })\n      setQuestionScores(scores)\n    }\n  }, [open, selectedQuestions, questionTypes])\n\n  // 更新題型預設分數\n  const updateTypeScore = (typeId: string, newScore: number) => {\n    setTypeScores((prev) =>\n      prev.map((t) => (t.typeId === typeId ? { ...t, defaultScore: newScore } : t))\n    )\n\n    // 同時更新該題型所有題目的分數\n    setQuestionScores((prev) =>\n      prev.map((qs) => {\n        const question = selectedQuestions.find((q) => q.id === qs.questionId)\n        if (question?.question_type_id === typeId) {\n          return { ...qs, score: newScore }\n        }\n        return qs\n      })\n    )\n  }\n\n  // 更新單題分數\n  const updateQuestionScore = (questionId: string, newScore: number) => {\n    setQuestionScores((prev) =>\n      prev.map((qs) => (qs.questionId === questionId ? { ...qs, score: newScore } : qs))\n    )\n  }\n\n  // 計算總分\n  const totalScore = questionScores.reduce((sum, qs) => sum + qs.score, 0)\n\n  // 取得題型標籤\n  const getTypeLabel = (typeId: string) => {\n    return questionTypes.find((t) => t.id === typeId)?.label || \"未知\"\n  }\n\n  // 取得題型名稱\n  const getTypeName = (typeId: string) => {\n    return questionTypes.find((t) => t.id === typeId)?.name || \"\"\n  }\n\n  // 格式化答案顯示\n  const formatAnswer = (question: Question) => {\n    const typeName = getTypeName(question.question_type_id)\n    const answer = question.answer\n\n    if (typeName === \"true_false\") {\n      return answer === \"true\" ? \"O\" : \"X\"\n    }\n    if (typeName === \"single_choice\") {\n      return answer as string\n    }\n    if (typeName === \"multiple_choice\") {\n      return Array.isArray(answer) ? answer.join(\"\") : answer\n    }\n    if (typeName === \"fill_in_blank\" || typeName === \"essay\") {\n      return answer as string\n    }\n    return String(answer)\n  }\n\n  // 格式化選項\n  const formatOptions = (question: Question) => {\n    if (!question.options) return null\n    const options = question.options as Array<{ label: string; text: string; image_url?: string }>\n    return options\n  }\n\n  // 生成 PDF\n  const generatePDF = async () => {\n    setGenerating(true)\n\n    try {\n      // 動態載入 html2canvas 和 jspdf\n      const html2canvas = (await import(\"html2canvas\")).default\n      const { jsPDF } = await import(\"jspdf\")\n\n      if (!printRef.current) return\n\n      // 使用 html2canvas 將內容轉為圖片\n      const canvas = await html2canvas(printRef.current, {\n        scale: 2,\n        useCORS: true,\n        logging: false,\n      })\n\n      const imgData = canvas.toDataURL(\"image/png\")\n      const pdf = new jsPDF(\"p\", \"mm\", \"a4\")\n\n      const pdfWidth = pdf.internal.pageSize.getWidth()\n      const pdfHeight = pdf.internal.pageSize.getHeight()\n      const imgWidth = canvas.width\n      const imgHeight = canvas.height\n      const ratio = Math.min(pdfWidth / imgWidth, pdfHeight / imgHeight)\n      const imgX = (pdfWidth - imgWidth * ratio) / 2\n      const imgY = 0\n\n      // 計算需要幾頁\n      const pageHeight = pdfHeight / ratio\n      let heightLeft = imgHeight\n      let position = 0\n\n      // 第一頁\n      pdf.addImage(imgData, \"PNG\", imgX, imgY, imgWidth * ratio, imgHeight * ratio)\n      heightLeft -= pageHeight\n\n      // 如果內容超過一頁，添加更多頁\n      while (heightLeft > 0) {\n        position -= pageHeight\n        pdf.addPage()\n        pdf.addImage(imgData, \"PNG\", imgX, position * ratio, imgWidth * ratio, imgHeight * ratio)\n        heightLeft -= pageHeight\n      }\n\n      // 下載 PDF\n      const fileName = includeAnswer ? `${examTitle}_教師版.pdf` : `${examTitle}_學生版.pdf`\n      pdf.save(fileName)\n    } catch (error) {\n      console.error(\"PDF 生成失敗:\", error)\n      alert(\"PDF 生成失敗，請稍後再試\")\n    } finally {\n      setGenerating(false)\n    }\n  }\n\n  // 按題型分組題目\n  const groupedQuestions: Record<string, Question[]> = {}\n  selectedQuestions.forEach((q) => {\n    const typeId = q.question_type_id\n    if (!groupedQuestions[typeId]) {\n      groupedQuestions[typeId] = []\n    }\n    groupedQuestions[typeId].push(q)\n  })\n\n  return (\n    <Dialog open={open} onOpenChange={onOpenChange}>\n      <DialogContent className=\"sm:max-w-[700px] max-h-[90vh] overflow-y-auto\">\n        <DialogHeader>\n          <DialogTitle>匯出試卷</DialogTitle>\n          <DialogDescription>\n            已選擇 {selectedQuestions.length} 題，設定配分後匯出 PDF\n          </DialogDescription>\n        </DialogHeader>\n\n        <div className=\"grid gap-4 py-4\">\n          {/* 試卷標題 */}\n          <div className=\"space-y-2\">\n            <Label>試卷標題</Label>\n            <Input\n              value={examTitle}\n              onChange={(e) => setExamTitle(e.target.value)}\n              placeholder=\"輸入試卷標題\"\n            />\n          </div>\n\n          {/* 包含答案選項 */}\n          <div className=\"flex items-center gap-2\">\n            <input\n              type=\"checkbox\"\n              id=\"includeAnswer\"\n              checked={includeAnswer}\n              onChange={(e) => setIncludeAnswer(e.target.checked)}\n              className=\"w-4 h-4\"\n            />\n            <label htmlFor=\"includeAnswer\" className=\"text-sm cursor-pointer\">\n              教師版（包含答案與解析）\n            </label>\n          </div>\n\n          {/* 題型配分設定 */}\n          <div className=\"space-y-3\">\n            <Label>題型配分設定</Label>\n            <div className=\"border rounded-lg divide-y\">\n              {typeScores.map((config) => (\n                <div key={config.typeId} className=\"flex items-center justify-between p-3\">\n                  <div>\n                    <span className=\"font-medium\">{config.typeLabel}</span>\n                    <span className=\"text-sm text-gray-500 ml-2\">({config.count} 題)</span>\n                  </div>\n                  <div className=\"flex items-center gap-2\">\n                    <span className=\"text-sm text-gray-500\">每題</span>\n                    <Input\n                      type=\"number\"\n                      min={0}\n                      value={config.defaultScore}\n                      onChange={(e) => updateTypeScore(config.typeId, Number(e.target.value))}\n                      className=\"w-20 text-center\"\n                    />\n                    <span className=\"text-sm text-gray-500\">分</span>\n                  </div>\n                </div>\n              ))}\n            </div>\n          </div>\n\n          {/* 展開個別題目配分 */}\n          <div>\n            <button\n              type=\"button\"\n              className=\"flex items-center gap-1 text-sm text-blue-600 hover:text-blue-700\"\n              onClick={() => setShowDetails(!showDetails)}\n            >\n              {showDetails ? <ChevronUp className=\"w-4 h-4\" /> : <ChevronDown className=\"w-4 h-4\" />}\n              {showDetails ? \"收起\" : \"展開\"}個別題目配分調整\n            </button>\n\n            {showDetails && (\n              <div className=\"mt-3 border rounded-lg max-h-60 overflow-y-auto\">\n                <table className=\"w-full text-sm\">\n                  <thead className=\"bg-gray-50 sticky top-0\">\n                    <tr>\n                      <th className=\"px-3 py-2 text-left font-medium text-gray-600\">題號</th>\n                      <th className=\"px-3 py-2 text-left font-medium text-gray-600\">題型</th>\n                      <th className=\"px-3 py-2 text-left font-medium text-gray-600\">題目</th>\n                      <th className=\"px-3 py-2 text-right font-medium text-gray-600\">分數</th>\n                    </tr>\n                  </thead>\n                  <tbody className=\"divide-y\">\n                    {selectedQuestions.map((q, index) => {\n                      const score = questionScores.find((qs) => qs.questionId === q.id)?.score || 0\n                      return (\n                        <tr key={q.id}>\n                          <td className=\"px-3 py-2\">{index + 1}</td>\n                          <td className=\"px-3 py-2 whitespace-nowrap\">\n                            {getTypeLabel(q.question_type_id)}\n                          </td>\n                          <td className=\"px-3 py-2\">\n                            <span className=\"line-clamp-1\">{q.content}</span>\n                          </td>\n                          <td className=\"px-3 py-2\">\n                            <Input\n                              type=\"number\"\n                              min={0}\n                              value={score}\n                              onChange={(e) => updateQuestionScore(q.id, Number(e.target.value))}\n                              className=\"w-16 text-center\"\n                            />\n                          </td>\n                        </tr>\n                      )\n                    })}\n                  </tbody>\n                </table>\n              </div>\n            )}\n          </div>\n\n          {/* 總分顯示 */}\n          <div className=\"flex items-center justify-between p-3 bg-blue-50 rounded-lg\">\n            <span className=\"font-medium text-blue-700\">總分</span>\n            <span className=\"text-xl font-bold text-blue-700\">{totalScore} 分</span>\n          </div>\n        </div>\n\n        <DialogFooter>\n          <Button variant=\"outline\" onClick={() => onOpenChange(false)} disabled={generating}>\n            取消\n          </Button>\n          <Button\n            className=\"bg-blue-600 hover:bg-blue-700\"\n            onClick={generatePDF}\n            disabled={generating}\n          >\n            {generating ? \"生成中...\" : \"匯出 PDF\"}\n          </Button>\n        </DialogFooter>\n\n        {/* 隱藏的列印內容 */}\n        <div className=\"fixed left-[-9999px] top-0\">\n          <div\n            ref={printRef}\n            className=\"bg-white p-8\"\n            style={{ width: \"210mm\", minHeight: \"297mm\", fontFamily: \"sans-serif\" }}\n          >\n            {/* 試卷標題 */}\n            <div className=\"text-center mb-6\">\n              <h1 className=\"text-2xl font-bold mb-2\">{examTitle}</h1>\n              <div className=\"flex justify-center gap-8 text-sm text-gray-600\">\n                <span>姓名：______________</span>\n                <span>座號：______</span>\n                <span>得分：______/{totalScore}</span>\n              </div>\n            </div>\n\n            {/* 題目內容 - 按題型分組 */}\n            {Object.entries(groupedQuestions).map(([typeId, questions], groupIndex) => {\n              const typeLabel = getTypeLabel(typeId)\n              const typeName = getTypeName(typeId)\n              const config = typeScores.find((t) => t.typeId === typeId)\n              const groupTotal = questions.reduce((sum, q) => {\n                const score = questionScores.find((qs) => qs.questionId === q.id)?.score || 0\n                return sum + score\n              }, 0)\n\n              // 計算題目起始編號\n              let startIndex = 0\n              Object.entries(groupedQuestions).forEach(([tId, qs]) => {\n                if (tId === typeId) return\n                const currentGroupIndex = Object.keys(groupedQuestions).indexOf(tId)\n                if (currentGroupIndex < groupIndex) {\n                  startIndex += qs.length\n                }\n              })\n\n              return (\n                <div key={typeId} className=\"mb-6\">\n                  {/* 題型標題 */}\n                  <div className=\"flex items-center justify-between mb-3 pb-2 border-b-2 border-gray-300\">\n                    <h2 className=\"text-lg font-bold\">\n                      {[\"一\", \"二\", \"三\", \"四\", \"五\"][groupIndex] || groupIndex + 1}、{typeLabel}\n                      <span className=\"text-sm font-normal text-gray-600 ml-2\">\n                        （共 {questions.length} 題，每題 {config?.defaultScore || 0} 分，共 {groupTotal} 分）\n                      </span>\n                    </h2>\n                  </div>\n\n                  {/* 題目列表 */}\n                  <div className=\"space-y-4\">\n                    {questions.map((question, qIndex) => {\n                      const questionNumber = startIndex + qIndex + 1\n                      const score = questionScores.find((qs) => qs.questionId === question.id)?.score || 0\n                      const options = formatOptions(question)\n                      const answer = formatAnswer(question)\n                      const hasImage = !!(question as any).image_url\n\n                      return (\n                        <div key={question.id} className=\"mb-4\">\n                          {/* 題目內容 */}\n                          <div className=\"flex gap-2\">\n                            <span className=\"font-medium shrink-0\">{questionNumber}.</span>\n                            <div className=\"flex-1\">\n                              <span>（{score}分）</span>\n                              <span className=\"ml-1\">{question.content}</span>\n                              \n                              {/* 題目圖片 */}\n                              {hasImage && (\n                                <div className=\"mt-2\">\n                                  <img\n                                    src={(question as any).image_url}\n                                    alt=\"題目圖片\"\n                                    className=\"max-h-40 object-contain\"\n                                  />\n                                </div>\n                              )}\n\n                              {/* 選項 */}\n                              {options && (\n                                <div className=\"mt-2 grid grid-cols-2 gap-x-4 gap-y-1\">\n                                  {options.map((opt) => (\n                                    <div key={opt.label} className=\"flex items-start gap-1\">\n                                      <span>({opt.label})</span>\n                                      <div>\n                                        <span>{opt.text}</span>\n                                        {opt.image_url && (\n                                          <img\n                                            src={opt.image_url}\n                                            alt={`選項 ${opt.label}`}\n                                            className=\"max-h-20 mt-1 object-contain\"\n                                          />\n                                        )}\n                                      </div>\n                                    </div>\n                                  ))}\n                                </div>\n                              )}\n\n                              {/* 填充題作答區 */}\n                              {typeName === \"fill_in_blank\" && !includeAnswer && (\n                                <div className=\"mt-2 text-gray-500\">\n                                  答：____________________\n                                </div>\n                              )}\n\n                              {/* 問答題作答區 */}\n                              {typeName === \"essay\" && !includeAnswer && (\n                                <div className=\"mt-2 border border-gray-300 rounded p-2 min-h-[80px]\">\n                                  <span className=\"text-gray-400 text-sm\">作答區</span>\n                                </div>\n                              )}\n\n                              {/* 答案（教師版） */}\n                              {includeAnswer && (\n                                <div className=\"mt-2 p-2 bg-green-50 border border-green-200 rounded\">\n                                  <span className=\"text-green-700 font-medium\">答案：</span>\n                                  <span className=\"text-green-700\">{answer}</span>\n                                  {question.explanation && (\n                                    <div className=\"mt-1 text-sm text-green-600\">\n                                      <span className=\"font-medium\">解析：</span>\n                                      {question.explanation}\n                                    </div>\n                                  )}\n                                </div>\n                              )}\n                            </div>\n                          </div>\n                        </div>\n                      )\n                    })}\n                  </div>\n                </div>\n              )\n            })}\n          </div>\n        </div>\n      </DialogContent>\n    </Dialog>\n  )\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3606, "column": 0}, "map": {"version":3,"sources":["file:///C:/Coding/Self_Learningv1/app/%28dashboard%29/dashboard/practice/page.tsx"],"sourcesContent":["// app/(dashboard)/dashboard/practice/page.tsx\n\"use client\"\n\nimport { useState, useEffect } from \"react\"\nimport { useRouter } from \"next/navigation\"\nimport { supabase } from \"@/lib/supabaseClient\"\nimport { Button } from \"@/components/ui/button\"\nimport { Card, CardContent } from \"@/components/ui/card\"\nimport { Checkbox } from \"@/components/ui/checkbox\"\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\"\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n} from \"@/components/ui/alert-dialog\"\nimport { QuestionForm } from \"@/components/questions/question-form\"\nimport { QuestionImport } from \"@/components/questions/question-import\"\nimport { ExamExport } from \"@/components/questions/exam-export\"\nimport {\n  FileQuestion,\n  Plus,\n  Upload,\n  FileDown,\n  MoreVertical,\n  Pencil,\n  Trash2,\n  CheckCircle,\n  XCircle,\n  HelpCircle,\n  ListChecks,\n  PenLine,\n  MessageSquare,\n  Image,\n  Square,\n  CheckSquare,\n  Play,\n  Settings,\n} from \"lucide-react\"\nimport type { Subject, Question, QuestionType } from \"@/types/supabase\"\n\n// 題型圖示對應\nconst typeIcons: Record<string, React.ElementType> = {\n  true_false: CheckCircle,\n  single_choice: HelpCircle,\n  multiple_choice: ListChecks,\n  fill_in_blank: PenLine,\n  essay: MessageSquare,\n}\n\n// 題型顏色對應\nconst typeColors: Record<string, string> = {\n  true_false: \"text-green-600 bg-green-100\",\n  single_choice: \"text-blue-600 bg-blue-100\",\n  multiple_choice: \"text-purple-600 bg-purple-100\",\n  fill_in_blank: \"text-amber-600 bg-amber-100\",\n  essay: \"text-pink-600 bg-pink-100\",\n}\n\nexport default function PracticePage() {\n  const router = useRouter()\n  const [subjects, setSubjects] = useState<Subject[]>([])\n  const [questionTypes, setQuestionTypes] = useState<QuestionType[]>([])\n  const [questions, setQuestions] = useState<Question[]>([])\n  const [loading, setLoading] = useState(true)\n\n  // 模式切換：練習模式 vs 管理模式\n  const [mode, setMode] = useState<\"practice\" | \"manage\">(\"practice\")\n\n  // 篩選條件\n  const [filterSubject, setFilterSubject] = useState<string>(\"all\")\n  const [filterType, setFilterType] = useState<string>(\"all\")\n\n  // 勾選狀態（管理模式用）\n  const [selectedIds, setSelectedIds] = useState<Set<string>>(new Set())\n  const [selectionMode, setSelectionMode] = useState(false)\n\n  // 表單狀態\n  const [formOpen, setFormOpen] = useState(false)\n  const [editingQuestion, setEditingQuestion] = useState<Question | null>(null)\n  const [editingTopicIds, setEditingTopicIds] = useState<string[]>([])\n\n  // 匯入對話框\n  const [importOpen, setImportOpen] = useState(false)\n\n  // 匯出對話框\n  const [exportOpen, setExportOpen] = useState(false)\n\n  // 刪除狀態\n  const [deleteDialogOpen, setDeleteDialogOpen] = useState(false)\n  const [deletingQuestion, setDeletingQuestion] = useState<Question | null>(null)\n  const [deleteLoading, setDeleteLoading] = useState(false)\n\n  // 載入資料\n  const fetchData = async () => {\n    const { data: { user } } = await supabase.auth.getUser()\n    if (!user) return\n\n    // 取得科目\n    const { data: subjectsData } = await supabase\n      .from(\"subjects\")\n      .select(\"*\")\n      .eq(\"user_id\", user.id)\n      .order(\"title\")\n\n    if (subjectsData) setSubjects(subjectsData)\n\n    // 取得題型\n    const { data: typesData } = await supabase\n      .from(\"question_types\")\n      .select(\"*\")\n\n    if (typesData) setQuestionTypes(typesData)\n\n    // 取得題目\n    await fetchQuestions(user.id)\n\n    setLoading(false)\n  }\n\n  const fetchQuestions = async (userId?: string) => {\n    if (!userId) {\n      const { data: { user } } = await supabase.auth.getUser()\n      if (!user) return\n      userId = user.id\n    }\n\n    let query = supabase\n      .from(\"questions\")\n      .select(\"*\")\n      .eq(\"user_id\", userId)\n      .is(\"parent_id\", null)\n      .order(\"created_at\", { ascending: false })\n\n    if (filterSubject !== \"all\") {\n      query = query.eq(\"subject_id\", filterSubject)\n    }\n\n    if (filterType !== \"all\") {\n      query = query.eq(\"question_type_id\", filterType)\n    }\n\n    const { data } = await query\n\n    if (data) setQuestions(data)\n  }\n\n  useEffect(() => {\n    fetchData()\n  }, [])\n\n  useEffect(() => {\n    fetchQuestions()\n    // 篩選改變時清除選擇\n    setSelectedIds(new Set())\n  }, [filterSubject, filterType])\n\n  // 開始練習（第一題或隨機）\n  const startPractice = (random: boolean = false) => {\n    if (questions.length === 0) return\n\n    let targetQuestion: Question\n    if (random) {\n      const randomIndex = Math.floor(Math.random() * questions.length)\n      targetQuestion = questions[randomIndex]\n    } else {\n      targetQuestion = questions[0]\n    }\n\n    router.push(`/dashboard/practice/${targetQuestion.id}`)\n  }\n\n  // 點擊題目開始練習\n  const goToPractice = (questionId: string) => {\n    router.push(`/dashboard/practice/${questionId}`)\n  }\n\n  // 切換選擇模式\n  const toggleSelectionMode = () => {\n    setSelectionMode(!selectionMode)\n    if (selectionMode) {\n      setSelectedIds(new Set())\n    }\n  }\n\n  // 切換單題選擇\n  const toggleSelect = (id: string) => {\n    const newSelected = new Set(selectedIds)\n    if (newSelected.has(id)) {\n      newSelected.delete(id)\n    } else {\n      newSelected.add(id)\n    }\n    setSelectedIds(newSelected)\n  }\n\n  // 全選/取消全選\n  const toggleSelectAll = () => {\n    if (selectedIds.size === questions.length) {\n      setSelectedIds(new Set())\n    } else {\n      setSelectedIds(new Set(questions.map((q) => q.id)))\n    }\n  }\n\n  // 取得已選題目\n  const selectedQuestions = questions.filter((q) => selectedIds.has(q.id))\n\n  // 開啟編輯表單\n  const openEditForm = async (question: Question) => {\n    const { data: topicLinks } = await supabase\n      .from(\"question_topics\")\n      .select(\"topic_id\")\n      .eq(\"question_id\", question.id)\n\n    setEditingQuestion(question)\n    setEditingTopicIds(topicLinks?.map((l) => l.topic_id) || [])\n    setFormOpen(true)\n  }\n\n  // 關閉表單\n  const closeForm = () => {\n    setFormOpen(false)\n    setEditingQuestion(null)\n    setEditingTopicIds([])\n  }\n\n  // 開啟刪除確認\n  const openDeleteDialog = (question: Question) => {\n    setDeletingQuestion(question)\n    setDeleteDialogOpen(true)\n  }\n\n  // 刪除題目\n  const handleDelete = async () => {\n    if (!deletingQuestion) return\n\n    setDeleteLoading(true)\n\n    await supabase\n      .from(\"question_topics\")\n      .delete()\n      .eq(\"question_id\", deletingQuestion.id)\n\n    const { error } = await supabase\n      .from(\"questions\")\n      .delete()\n      .eq(\"id\", deletingQuestion.id)\n\n    if (!error) {\n      await fetchQuestions()\n      selectedIds.delete(deletingQuestion.id)\n      setSelectedIds(new Set(selectedIds))\n    }\n\n    setDeleteLoading(false)\n    setDeleteDialogOpen(false)\n    setDeletingQuestion(null)\n  }\n\n  // 取得題型資訊\n  const getQuestionType = (typeId: string) => {\n    return questionTypes.find((t) => t.id === typeId)\n  }\n\n  // 取得科目資訊\n  const getSubject = (subjectId: string) => {\n    return subjects.find((s) => s.id === subjectId)\n  }\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center py-12\">\n        <div className=\"w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full animate-spin\" />\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      {/* 頁面標題 */}\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h1 className=\"text-2xl font-bold text-gray-800\">題庫練習</h1>\n          <p className=\"text-gray-600 mt-1\">\n            {mode === \"practice\" ? \"選擇題目開始練習\" : \"管理練習題目\"}\n          </p>\n        </div>\n        <div className=\"flex gap-2\">\n          {/* 模式切換 */}\n          <Button\n            variant={mode === \"manage\" ? \"default\" : \"outline\"}\n            onClick={() => {\n              setMode(mode === \"practice\" ? \"manage\" : \"practice\")\n              setSelectionMode(false)\n              setSelectedIds(new Set())\n            }}\n            className={mode === \"manage\" ? \"bg-gray-600 hover:bg-gray-700\" : \"\"}\n          >\n            <Settings className=\"w-4 h-4 mr-2\" />\n            {mode === \"practice\" ? \"管理模式\" : \"練習模式\"}\n          </Button>\n\n          {/* 練習模式按鈕 */}\n          {mode === \"practice\" && questions.length > 0 && (\n            <>\n              <Button variant=\"outline\" onClick={() => startPractice(true)}>\n                🎲 隨機練習\n              </Button>\n              <Button\n                className=\"bg-green-600 hover:bg-green-700\"\n                onClick={() => startPractice(false)}\n              >\n                <Play className=\"w-4 h-4 mr-2\" />\n                開始練習\n              </Button>\n            </>\n          )}\n\n          {/* 管理模式按鈕 */}\n          {mode === \"manage\" && (\n            <>\n              <Button\n                variant={selectionMode ? \"default\" : \"outline\"}\n                onClick={toggleSelectionMode}\n                className={selectionMode ? \"bg-blue-600 hover:bg-blue-700\" : \"\"}\n              >\n                {selectionMode ? (\n                  <>\n                    <CheckSquare className=\"w-4 h-4 mr-2\" />\n                    完成選擇\n                  </>\n                ) : (\n                  <>\n                    <Square className=\"w-4 h-4 mr-2\" />\n                    選擇題目\n                  </>\n                )}\n              </Button>\n              <Button variant=\"outline\" onClick={() => setImportOpen(true)}>\n                <Upload className=\"w-4 h-4 mr-2\" />\n                批次匯入\n              </Button>\n              <Button\n                onClick={() => setFormOpen(true)}\n                className=\"bg-blue-600 hover:bg-blue-700\"\n              >\n                <Plus className=\"w-4 h-4 mr-2\" />\n                新增題目\n              </Button>\n            </>\n          )}\n        </div>\n      </div>\n\n      {/* 選擇模式工具列（管理模式） */}\n      {mode === \"manage\" && selectionMode && (\n        <div className=\"flex items-center justify-between p-3 bg-blue-50 rounded-lg\">\n          <div className=\"flex items-center gap-4\">\n            <button\n              onClick={toggleSelectAll}\n              className=\"flex items-center gap-2 text-sm text-blue-700 hover:text-blue-800\"\n            >\n              {selectedIds.size === questions.length ? (\n                <>\n                  <CheckSquare className=\"w-4 h-4\" />\n                  取消全選\n                </>\n              ) : (\n                <>\n                  <Square className=\"w-4 h-4\" />\n                  全選\n                </>\n              )}\n            </button>\n            <span className=\"text-sm text-blue-700\">\n              已選擇 {selectedIds.size} 題\n            </span>\n          </div>\n          <Button\n            onClick={() => setExportOpen(true)}\n            disabled={selectedIds.size === 0}\n            className=\"bg-green-600 hover:bg-green-700\"\n          >\n            <FileDown className=\"w-4 h-4 mr-2\" />\n            匯出試卷\n          </Button>\n        </div>\n      )}\n\n      {/* 篩選列 */}\n      <div className=\"flex flex-wrap gap-4\">\n        <div className=\"w-48\">\n          <Select value={filterSubject} onValueChange={setFilterSubject}>\n            <SelectTrigger>\n              <SelectValue placeholder=\"選擇科目\" />\n            </SelectTrigger>\n            <SelectContent>\n              <SelectItem value=\"all\">所有科目</SelectItem>\n              {subjects.map((subject) => (\n                <SelectItem key={subject.id} value={subject.id}>\n                  {subject.title}\n                </SelectItem>\n              ))}\n            </SelectContent>\n          </Select>\n        </div>\n        <div className=\"w-48\">\n          <Select value={filterType} onValueChange={setFilterType}>\n            <SelectTrigger>\n              <SelectValue placeholder=\"選擇題型\" />\n            </SelectTrigger>\n            <SelectContent>\n              <SelectItem value=\"all\">所有題型</SelectItem>\n              {questionTypes.map((type) => (\n                <SelectItem key={type.id} value={type.id}>\n                  {type.label}\n                </SelectItem>\n              ))}\n            </SelectContent>\n          </Select>\n        </div>\n        {questions.length > 0 && (\n          <div className=\"flex items-center text-sm text-gray-500\">\n            共 {questions.length} 題\n          </div>\n        )}\n      </div>\n\n      {/* 題目列表 */}\n      {questions.length === 0 ? (\n        <Card>\n          <CardContent className=\"flex flex-col items-center justify-center py-12\">\n            <div className=\"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mb-4\">\n              <FileQuestion className=\"w-8 h-8 text-green-600\" />\n            </div>\n            <h3 className=\"text-lg font-semibold text-gray-800 mb-2\">\n              尚未建立題目\n            </h3>\n            <p className=\"text-gray-600 text-center mb-4\">\n              開始建立練習題目吧！\n            </p>\n            <div className=\"flex gap-2\">\n              <Button variant=\"outline\" onClick={() => setImportOpen(true)}>\n                <Upload className=\"w-4 h-4 mr-2\" />\n                批次匯入\n              </Button>\n              <Button\n                onClick={() => {\n                  setMode(\"manage\")\n                  setFormOpen(true)\n                }}\n                className=\"bg-blue-600 hover:bg-blue-700\"\n              >\n                <Plus className=\"w-4 h-4 mr-2\" />\n                新增題目\n              </Button>\n            </div>\n          </CardContent>\n        </Card>\n      ) : (\n        <div className=\"space-y-3\">\n          {questions.map((question) => (\n            <QuestionCard\n              key={question.id}\n              question={question}\n              questionType={getQuestionType(question.question_type_id)}\n              subject={getSubject(question.subject_id)}\n              mode={mode}\n              selectionMode={selectionMode}\n              isSelected={selectedIds.has(question.id)}\n              onToggleSelect={() => toggleSelect(question.id)}\n              onPractice={() => goToPractice(question.id)}\n              onEdit={() => openEditForm(question)}\n              onDelete={() => openDeleteDialog(question)}\n            />\n          ))}\n        </div>\n      )}\n\n      {/* 新增/編輯表單 */}\n      <QuestionForm\n        open={formOpen}\n        onOpenChange={closeForm}\n        onSuccess={() => {\n          fetchQuestions()\n          closeForm()\n        }}\n        question={editingQuestion}\n        questionTopicIds={editingTopicIds}\n      />\n\n      {/* 批次匯入 */}\n      <QuestionImport\n        open={importOpen}\n        onOpenChange={setImportOpen}\n        onSuccess={() => fetchQuestions()}\n        subjects={subjects}\n        questionTypes={questionTypes}\n      />\n\n      {/* 匯出試卷 */}\n      <ExamExport\n        open={exportOpen}\n        onOpenChange={setExportOpen}\n        selectedQuestions={selectedQuestions}\n        questionTypes={questionTypes}\n      />\n\n      {/* 刪除確認對話框 */}\n      <AlertDialog open={deleteDialogOpen} onOpenChange={setDeleteDialogOpen}>\n        <AlertDialogContent>\n          <AlertDialogHeader>\n            <AlertDialogTitle>確定要刪除嗎？</AlertDialogTitle>\n            <AlertDialogDescription>\n              刪除此題目後無法復原。\n            </AlertDialogDescription>\n          </AlertDialogHeader>\n          <AlertDialogFooter>\n            <AlertDialogCancel>取消</AlertDialogCancel>\n            <AlertDialogAction\n              onClick={handleDelete}\n              className=\"bg-red-600 hover:bg-red-700\"\n              disabled={deleteLoading}\n            >\n              {deleteLoading ? \"刪除中...\" : \"確定刪除\"}\n            </AlertDialogAction>\n          </AlertDialogFooter>\n        </AlertDialogContent>\n      </AlertDialog>\n    </div>\n  )\n}\n\n// 題目卡片元件\nfunction QuestionCard({\n  question,\n  questionType,\n  subject,\n  mode,\n  selectionMode,\n  isSelected,\n  onToggleSelect,\n  onPractice,\n  onEdit,\n  onDelete,\n}: {\n  question: Question\n  questionType?: QuestionType\n  subject?: Subject\n  mode: \"practice\" | \"manage\"\n  selectionMode: boolean\n  isSelected: boolean\n  onToggleSelect: () => void\n  onPractice: () => void\n  onEdit: () => void\n  onDelete: () => void\n}) {\n  const [showMenu, setShowMenu] = useState(false)\n\n  const Icon = questionType ? typeIcons[questionType.name] || HelpCircle : HelpCircle\n  const colorClass = questionType\n    ? typeColors[questionType.name] || \"text-gray-600 bg-gray-100\"\n    : \"text-gray-600 bg-gray-100\"\n  const hasImage = !!(question as any).image_url\n  const consecutiveCorrect = (question as any).consecutive_correct || 0\n\n  // 練習模式：點擊整張卡片進入練習\n  const handleCardClick = () => {\n    if (mode === \"practice\") {\n      onPractice()\n    } else if (selectionMode) {\n      onToggleSelect()\n    }\n  }\n\n  return (\n    <Card\n      className={`group transition-all ${\n        isSelected ? \"ring-2 ring-blue-500 bg-blue-50\" : \"\"\n      } ${mode === \"practice\" || selectionMode ? \"cursor-pointer hover:shadow-md\" : \"\"}`}\n      onClick={handleCardClick}\n    >\n      <CardContent className=\"p-4\">\n        <div className=\"flex items-start gap-4\">\n          {/* 勾選框（管理模式 + 選擇模式） */}\n          {mode === \"manage\" && selectionMode && (\n            <div className=\"pt-1\">\n              <Checkbox\n                checked={isSelected}\n                onCheckedChange={onToggleSelect}\n                onClick={(e) => e.stopPropagation()}\n              />\n            </div>\n          )}\n\n          {/* 題型圖示 */}\n          <div\n            className={`w-10 h-10 rounded-lg flex items-center justify-center shrink-0 ${colorClass}`}\n          >\n            <Icon className=\"w-5 h-5\" />\n          </div>\n\n          {/* 題目內容 */}\n          <div className=\"flex-1 min-w-0\">\n            <div className=\"flex items-center gap-2 mb-1 flex-wrap\">\n              <span className=\"text-xs px-2 py-0.5 bg-gray-100 rounded text-gray-600\">\n                {subject?.title || \"未分類\"}\n              </span>\n              <span className=\"text-xs px-2 py-0.5 bg-gray-100 rounded text-gray-600\">\n                {questionType?.label || \"未知題型\"}\n              </span>\n              {hasImage && (\n                <span className=\"text-xs px-2 py-0.5 bg-blue-100 rounded text-blue-600 flex items-center gap-1\">\n                  <Image className=\"w-3 h-3\" />\n                  含圖片\n                </span>\n              )}\n              {question.marked_for_review && (\n                <span className=\"text-xs px-2 py-0.5 bg-amber-100 rounded text-amber-600\">\n                  待複習\n                </span>\n              )}\n              {consecutiveCorrect >= 3 && (\n                <span className=\"text-xs px-2 py-0.5 bg-green-100 rounded text-green-600\">\n                  ✓ 已熟練\n                </span>\n              )}\n            </div>\n            <p className=\"text-gray-800 line-clamp-2\">{question.content}</p>\n            {question.attempt_count > 0 && (\n              <div className=\"flex items-center gap-3 text-xs text-gray-500 mt-1\">\n                <span>作答 {question.attempt_count} 次</span>\n                <span>答錯 {question.wrong_count} 次</span>\n                <span>連續答對 {consecutiveCorrect} 次</span>\n              </div>\n            )}\n          </div>\n\n          {/* 練習模式：顯示練習按鈕 */}\n          {mode === \"practice\" && (\n            <Button\n              size=\"sm\"\n              className=\"shrink-0 bg-green-600 hover:bg-green-700\"\n              onClick={(e) => {\n                e.stopPropagation()\n                onPractice()\n              }}\n            >\n              <Play className=\"w-4 h-4 mr-1\" />\n              練習\n            </Button>\n          )}\n\n          {/* 管理模式：顯示選單（非選擇模式） */}\n          {mode === \"manage\" && !selectionMode && (\n            <div className=\"relative shrink-0\">\n              <Button\n                variant=\"ghost\"\n                size=\"icon\"\n                className=\"h-8 w-8 opacity-0 group-hover:opacity-100 transition-opacity\"\n                onClick={(e) => {\n                  e.stopPropagation()\n                  setShowMenu(!showMenu)\n                }}\n              >\n                <MoreVertical className=\"h-4 w-4\" />\n              </Button>\n\n              {showMenu && (\n                <>\n                  <div\n                    className=\"fixed inset-0 z-10\"\n                    onClick={() => setShowMenu(false)}\n                  />\n                  <div className=\"absolute right-0 top-8 z-20 w-32 bg-white rounded-md shadow-lg border py-1\">\n                    <button\n                      className=\"flex items-center w-full px-3 py-2 text-sm text-gray-700 hover:bg-gray-100\"\n                      onClick={(e) => {\n                        e.stopPropagation()\n                        setShowMenu(false)\n                        onEdit()\n                      }}\n                    >\n                      <Pencil className=\"h-4 w-4 mr-2\" />\n                      編輯\n                    </button>\n                    <button\n                      className=\"flex items-center w-full px-3 py-2 text-sm text-red-600 hover:bg-red-50\"\n                      onClick={(e) => {\n                        e.stopPropagation()\n                        setShowMenu(false)\n                        onDelete()\n                      }}\n                    >\n                      <Trash2 className=\"h-4 w-4 mr-2\" />\n                      刪除\n                    </button>\n                  </div>\n                </>\n              )}\n            </div>\n          )}\n        </div>\n      </CardContent>\n    </Card>\n  )\n}\n"],"names":[],"mappings":"AAAA,8CAA8C;;;;;;AAG9C;AACA;AACA;AACA;AACA;AACA;AACA;AAOA;AAUA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AA5BA;;;;;;;;;;;;;;AAkDA,SAAS;AACT,MAAM,YAA+C;IACnD,YAAY,0OAAW;IACvB,eAAe,4OAAU;IACzB,iBAAiB,gOAAU;IAC3B,eAAe,uNAAO;IACtB,OAAO,yOAAa;AACtB;AAEA,SAAS;AACT,MAAM,aAAqC;IACzC,YAAY;IACZ,eAAe;IACf,iBAAiB;IACjB,eAAe;IACf,OAAO;AACT;AAEe,SAAS;IACtB,MAAM,SAAS,IAAA,+IAAS;IACxB,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,iNAAQ,EAAY,EAAE;IACtD,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,iNAAQ,EAAiB,EAAE;IACrE,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,iNAAQ,EAAa,EAAE;IACzD,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAC;IAEvC,oBAAoB;IACpB,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,iNAAQ,EAAwB;IAExD,OAAO;IACP,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,iNAAQ,EAAS;IAC3D,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,iNAAQ,EAAS;IAErD,cAAc;IACd,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,iNAAQ,EAAc,IAAI;IAChE,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,iNAAQ,EAAC;IAEnD,OAAO;IACP,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,iNAAQ,EAAC;IACzC,MAAM,CAAC,iBAAiB,mBAAmB,GAAG,IAAA,iNAAQ,EAAkB;IACxE,MAAM,CAAC,iBAAiB,mBAAmB,GAAG,IAAA,iNAAQ,EAAW,EAAE;IAEnE,QAAQ;IACR,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,iNAAQ,EAAC;IAE7C,QAAQ;IACR,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,iNAAQ,EAAC;IAE7C,OAAO;IACP,MAAM,CAAC,kBAAkB,oBAAoB,GAAG,IAAA,iNAAQ,EAAC;IACzD,MAAM,CAAC,kBAAkB,oBAAoB,GAAG,IAAA,iNAAQ,EAAkB;IAC1E,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,iNAAQ,EAAC;IAEnD,OAAO;IACP,MAAM,YAAY;QAChB,MAAM,EAAE,MAAM,EAAE,IAAI,EAAE,EAAE,GAAG,MAAM,iIAAQ,CAAC,IAAI,CAAC,OAAO;QACtD,IAAI,CAAC,MAAM;QAEX,OAAO;QACP,MAAM,EAAE,MAAM,YAAY,EAAE,GAAG,MAAM,iIAAQ,CAC1C,IAAI,CAAC,YACL,MAAM,CAAC,KACP,EAAE,CAAC,WAAW,KAAK,EAAE,EACrB,KAAK,CAAC;QAET,IAAI,cAAc,YAAY;QAE9B,OAAO;QACP,MAAM,EAAE,MAAM,SAAS,EAAE,GAAG,MAAM,iIAAQ,CACvC,IAAI,CAAC,kBACL,MAAM,CAAC;QAEV,IAAI,WAAW,iBAAiB;QAEhC,OAAO;QACP,MAAM,eAAe,KAAK,EAAE;QAE5B,WAAW;IACb;IAEA,MAAM,iBAAiB,OAAO;QAC5B,IAAI,CAAC,QAAQ;YACX,MAAM,EAAE,MAAM,EAAE,IAAI,EAAE,EAAE,GAAG,MAAM,iIAAQ,CAAC,IAAI,CAAC,OAAO;YACtD,IAAI,CAAC,MAAM;YACX,SAAS,KAAK,EAAE;QAClB;QAEA,IAAI,QAAQ,iIAAQ,CACjB,IAAI,CAAC,aACL,MAAM,CAAC,KACP,EAAE,CAAC,WAAW,QACd,EAAE,CAAC,aAAa,MAChB,KAAK,CAAC,cAAc;YAAE,WAAW;QAAM;QAE1C,IAAI,kBAAkB,OAAO;YAC3B,QAAQ,MAAM,EAAE,CAAC,cAAc;QACjC;QAEA,IAAI,eAAe,OAAO;YACxB,QAAQ,MAAM,EAAE,CAAC,oBAAoB;QACvC;QAEA,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM;QAEvB,IAAI,MAAM,aAAa;IACzB;IAEA,IAAA,kNAAS,EAAC;QACR;IACF,GAAG,EAAE;IAEL,IAAA,kNAAS,EAAC;QACR;QACA,YAAY;QACZ,eAAe,IAAI;IACrB,GAAG;QAAC;QAAe;KAAW;IAE9B,eAAe;IACf,MAAM,gBAAgB,CAAC,SAAkB,KAAK;QAC5C,IAAI,UAAU,MAAM,KAAK,GAAG;QAE5B,IAAI;QACJ,IAAI,QAAQ;YACV,MAAM,cAAc,KAAK,KAAK,CAAC,KAAK,MAAM,KAAK,UAAU,MAAM;YAC/D,iBAAiB,SAAS,CAAC,YAAY;QACzC,OAAO;YACL,iBAAiB,SAAS,CAAC,EAAE;QAC/B;QAEA,OAAO,IAAI,CAAC,CAAC,oBAAoB,EAAE,eAAe,EAAE,EAAE;IACxD;IAEA,WAAW;IACX,MAAM,eAAe,CAAC;QACpB,OAAO,IAAI,CAAC,CAAC,oBAAoB,EAAE,YAAY;IACjD;IAEA,SAAS;IACT,MAAM,sBAAsB;QAC1B,iBAAiB,CAAC;QAClB,IAAI,eAAe;YACjB,eAAe,IAAI;QACrB;IACF;IAEA,SAAS;IACT,MAAM,eAAe,CAAC;QACpB,MAAM,cAAc,IAAI,IAAI;QAC5B,IAAI,YAAY,GAAG,CAAC,KAAK;YACvB,YAAY,MAAM,CAAC;QACrB,OAAO;YACL,YAAY,GAAG,CAAC;QAClB;QACA,eAAe;IACjB;IAEA,UAAU;IACV,MAAM,kBAAkB;QACtB,IAAI,YAAY,IAAI,KAAK,UAAU,MAAM,EAAE;YACzC,eAAe,IAAI;QACrB,OAAO;YACL,eAAe,IAAI,IAAI,UAAU,GAAG,CAAC,CAAC,IAAM,EAAE,EAAE;QAClD;IACF;IAEA,SAAS;IACT,MAAM,oBAAoB,UAAU,MAAM,CAAC,CAAC,IAAM,YAAY,GAAG,CAAC,EAAE,EAAE;IAEtE,SAAS;IACT,MAAM,eAAe,OAAO;QAC1B,MAAM,EAAE,MAAM,UAAU,EAAE,GAAG,MAAM,iIAAQ,CACxC,IAAI,CAAC,mBACL,MAAM,CAAC,YACP,EAAE,CAAC,eAAe,SAAS,EAAE;QAEhC,mBAAmB;QACnB,mBAAmB,YAAY,IAAI,CAAC,IAAM,EAAE,QAAQ,KAAK,EAAE;QAC3D,YAAY;IACd;IAEA,OAAO;IACP,MAAM,YAAY;QAChB,YAAY;QACZ,mBAAmB;QACnB,mBAAmB,EAAE;IACvB;IAEA,SAAS;IACT,MAAM,mBAAmB,CAAC;QACxB,oBAAoB;QACpB,oBAAoB;IACtB;IAEA,OAAO;IACP,MAAM,eAAe;QACnB,IAAI,CAAC,kBAAkB;QAEvB,iBAAiB;QAEjB,MAAM,iIAAQ,CACX,IAAI,CAAC,mBACL,MAAM,GACN,EAAE,CAAC,eAAe,iBAAiB,EAAE;QAExC,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,iIAAQ,CAC7B,IAAI,CAAC,aACL,MAAM,GACN,EAAE,CAAC,MAAM,iBAAiB,EAAE;QAE/B,IAAI,CAAC,OAAO;YACV,MAAM;YACN,YAAY,MAAM,CAAC,iBAAiB,EAAE;YACtC,eAAe,IAAI,IAAI;QACzB;QAEA,iBAAiB;QACjB,oBAAoB;QACpB,oBAAoB;IACtB;IAEA,SAAS;IACT,MAAM,kBAAkB,CAAC;QACvB,OAAO,cAAc,IAAI,CAAC,CAAC,IAAM,EAAE,EAAE,KAAK;IAC5C;IAEA,SAAS;IACT,MAAM,aAAa,CAAC;QAClB,OAAO,SAAS,IAAI,CAAC,CAAC,IAAM,EAAE,EAAE,KAAK;IACvC;IAEA,IAAI,SAAS;QACX,qBACE,8OAAC;YAAI,WAAU;sBACb,cAAA,8OAAC;gBAAI,WAAU;;;;;;;;;;;IAGrB;IAEA,qBACE,8OAAC;QAAI,WAAU;;0BAEb,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;;0CACC,8OAAC;gCAAG,WAAU;0CAAmC;;;;;;0CACjD,8OAAC;gCAAE,WAAU;0CACV,SAAS,aAAa,aAAa;;;;;;;;;;;;kCAGxC,8OAAC;wBAAI,WAAU;;0CAEb,8OAAC,qIAAM;gCACL,SAAS,SAAS,WAAW,YAAY;gCACzC,SAAS;oCACP,QAAQ,SAAS,aAAa,WAAW;oCACzC,iBAAiB;oCACjB,eAAe,IAAI;gCACrB;gCACA,WAAW,SAAS,WAAW,kCAAkC;;kDAEjE,8OAAC,sNAAQ;wCAAC,WAAU;;;;;;oCACnB,SAAS,aAAa,SAAS;;;;;;;4BAIjC,SAAS,cAAc,UAAU,MAAM,GAAG,mBACzC;;kDACE,8OAAC,qIAAM;wCAAC,SAAQ;wCAAU,SAAS,IAAM,cAAc;kDAAO;;;;;;kDAG9D,8OAAC,qIAAM;wCACL,WAAU;wCACV,SAAS,IAAM,cAAc;;0DAE7B,8OAAC,0MAAI;gDAAC,WAAU;;;;;;4CAAiB;;;;;;;;;4BAOtC,SAAS,0BACR;;kDACE,8OAAC,qIAAM;wCACL,SAAS,gBAAgB,YAAY;wCACrC,SAAS;wCACT,WAAW,gBAAgB,kCAAkC;kDAE5D,8BACC;;8DACE,8OAAC,0OAAW;oDAAC,WAAU;;;;;;gDAAiB;;yEAI1C;;8DACE,8OAAC,gNAAM;oDAAC,WAAU;;;;;;gDAAiB;;;;;;;;kDAKzC,8OAAC,qIAAM;wCAAC,SAAQ;wCAAU,SAAS,IAAM,cAAc;;0DACrD,8OAAC,gNAAM;gDAAC,WAAU;;;;;;4CAAiB;;;;;;;kDAGrC,8OAAC,qIAAM;wCACL,SAAS,IAAM,YAAY;wCAC3B,WAAU;;0DAEV,8OAAC,0MAAI;gDAAC,WAAU;;;;;;4CAAiB;;;;;;;;;;;;;;;;;;;;;YAS1C,SAAS,YAAY,+BACpB,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCACC,SAAS;gCACT,WAAU;0CAET,YAAY,IAAI,KAAK,UAAU,MAAM,iBACpC;;sDACE,8OAAC,0OAAW;4CAAC,WAAU;;;;;;wCAAY;;iEAIrC;;sDACE,8OAAC,gNAAM;4CAAC,WAAU;;;;;;wCAAY;;;;;;;;0CAKpC,8OAAC;gCAAK,WAAU;;oCAAwB;oCACjC,YAAY,IAAI;oCAAC;;;;;;;;;;;;;kCAG1B,8OAAC,qIAAM;wBACL,SAAS,IAAM,cAAc;wBAC7B,UAAU,YAAY,IAAI,KAAK;wBAC/B,WAAU;;0CAEV,8OAAC,0NAAQ;gCAAC,WAAU;;;;;;4BAAiB;;;;;;;;;;;;;0BAO3C,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAI,WAAU;kCACb,cAAA,8OAAC,qIAAM;4BAAC,OAAO;4BAAe,eAAe;;8CAC3C,8OAAC,4IAAa;8CACZ,cAAA,8OAAC,0IAAW;wCAAC,aAAY;;;;;;;;;;;8CAE3B,8OAAC,4IAAa;;sDACZ,8OAAC,yIAAU;4CAAC,OAAM;sDAAM;;;;;;wCACvB,SAAS,GAAG,CAAC,CAAC,wBACb,8OAAC,yIAAU;gDAAkB,OAAO,QAAQ,EAAE;0DAC3C,QAAQ,KAAK;+CADC,QAAQ,EAAE;;;;;;;;;;;;;;;;;;;;;;kCAOnC,8OAAC;wBAAI,WAAU;kCACb,cAAA,8OAAC,qIAAM;4BAAC,OAAO;4BAAY,eAAe;;8CACxC,8OAAC,4IAAa;8CACZ,cAAA,8OAAC,0IAAW;wCAAC,aAAY;;;;;;;;;;;8CAE3B,8OAAC,4IAAa;;sDACZ,8OAAC,yIAAU;4CAAC,OAAM;sDAAM;;;;;;wCACvB,cAAc,GAAG,CAAC,CAAC,qBAClB,8OAAC,yIAAU;gDAAe,OAAO,KAAK,EAAE;0DACrC,KAAK,KAAK;+CADI,KAAK,EAAE;;;;;;;;;;;;;;;;;;;;;;oBAO/B,UAAU,MAAM,GAAG,mBAClB,8OAAC;wBAAI,WAAU;;4BAA0C;4BACpD,UAAU,MAAM;4BAAC;;;;;;;;;;;;;YAMzB,UAAU,MAAM,KAAK,kBACpB,8OAAC,iIAAI;0BACH,cAAA,8OAAC,wIAAW;oBAAC,WAAU;;sCACrB,8OAAC;4BAAI,WAAU;sCACb,cAAA,8OAAC,8OAAY;gCAAC,WAAU;;;;;;;;;;;sCAE1B,8OAAC;4BAAG,WAAU;sCAA2C;;;;;;sCAGzD,8OAAC;4BAAE,WAAU;sCAAiC;;;;;;sCAG9C,8OAAC;4BAAI,WAAU;;8CACb,8OAAC,qIAAM;oCAAC,SAAQ;oCAAU,SAAS,IAAM,cAAc;;sDACrD,8OAAC,gNAAM;4CAAC,WAAU;;;;;;wCAAiB;;;;;;;8CAGrC,8OAAC,qIAAM;oCACL,SAAS;wCACP,QAAQ;wCACR,YAAY;oCACd;oCACA,WAAU;;sDAEV,8OAAC,0MAAI;4CAAC,WAAU;;;;;;wCAAiB;;;;;;;;;;;;;;;;;;;;;;;qCAOzC,8OAAC;gBAAI,WAAU;0BACZ,UAAU,GAAG,CAAC,CAAC,yBACd,8OAAC;wBAEC,UAAU;wBACV,cAAc,gBAAgB,SAAS,gBAAgB;wBACvD,SAAS,WAAW,SAAS,UAAU;wBACvC,MAAM;wBACN,eAAe;wBACf,YAAY,YAAY,GAAG,CAAC,SAAS,EAAE;wBACvC,gBAAgB,IAAM,aAAa,SAAS,EAAE;wBAC9C,YAAY,IAAM,aAAa,SAAS,EAAE;wBAC1C,QAAQ,IAAM,aAAa;wBAC3B,UAAU,IAAM,iBAAiB;uBAV5B,SAAS,EAAE;;;;;;;;;;0BAiBxB,8OAAC,4JAAY;gBACX,MAAM;gBACN,cAAc;gBACd,WAAW;oBACT;oBACA;gBACF;gBACA,UAAU;gBACV,kBAAkB;;;;;;0BAIpB,8OAAC,gKAAc;gBACb,MAAM;gBACN,cAAc;gBACd,WAAW,IAAM;gBACjB,UAAU;gBACV,eAAe;;;;;;0BAIjB,8OAAC,wJAAU;gBACT,MAAM;gBACN,cAAc;gBACd,mBAAmB;gBACnB,eAAe;;;;;;0BAIjB,8OAAC,mJAAW;gBAAC,MAAM;gBAAkB,cAAc;0BACjD,cAAA,8OAAC,0JAAkB;;sCACjB,8OAAC,yJAAiB;;8CAChB,8OAAC,wJAAgB;8CAAC;;;;;;8CAClB,8OAAC,8JAAsB;8CAAC;;;;;;;;;;;;sCAI1B,8OAAC,yJAAiB;;8CAChB,8OAAC,yJAAiB;8CAAC;;;;;;8CACnB,8OAAC,yJAAiB;oCAChB,SAAS;oCACT,WAAU;oCACV,UAAU;8CAET,gBAAgB,WAAW;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAO1C;AAEA,SAAS;AACT,SAAS,aAAa,EACpB,QAAQ,EACR,YAAY,EACZ,OAAO,EACP,IAAI,EACJ,aAAa,EACb,UAAU,EACV,cAAc,EACd,UAAU,EACV,MAAM,EACN,QAAQ,EAYT;IACC,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,iNAAQ,EAAC;IAEzC,MAAM,OAAO,eAAe,SAAS,CAAC,aAAa,IAAI,CAAC,IAAI,4OAAU,GAAG,4OAAU;IACnF,MAAM,aAAa,eACf,UAAU,CAAC,aAAa,IAAI,CAAC,IAAI,8BACjC;IACJ,MAAM,WAAW,CAAC,CAAC,AAAC,SAAiB,SAAS;IAC9C,MAAM,qBAAqB,AAAC,SAAiB,mBAAmB,IAAI;IAEpE,kBAAkB;IAClB,MAAM,kBAAkB;QACtB,IAAI,SAAS,YAAY;YACvB;QACF,OAAO,IAAI,eAAe;YACxB;QACF;IACF;IAEA,qBACE,8OAAC,iIAAI;QACH,WAAW,CAAC,qBAAqB,EAC/B,aAAa,oCAAoC,GAClD,CAAC,EAAE,SAAS,cAAc,gBAAgB,mCAAmC,IAAI;QAClF,SAAS;kBAET,cAAA,8OAAC,wIAAW;YAAC,WAAU;sBACrB,cAAA,8OAAC;gBAAI,WAAU;;oBAEZ,SAAS,YAAY,+BACpB,8OAAC;wBAAI,WAAU;kCACb,cAAA,8OAAC,yIAAQ;4BACP,SAAS;4BACT,iBAAiB;4BACjB,SAAS,CAAC,IAAM,EAAE,eAAe;;;;;;;;;;;kCAMvC,8OAAC;wBACC,WAAW,CAAC,+DAA+D,EAAE,YAAY;kCAEzF,cAAA,8OAAC;4BAAK,WAAU;;;;;;;;;;;kCAIlB,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCAAI,WAAU;;kDACb,8OAAC;wCAAK,WAAU;kDACb,SAAS,SAAS;;;;;;kDAErB,8OAAC;wCAAK,WAAU;kDACb,cAAc,SAAS;;;;;;oCAEzB,0BACC,8OAAC;wCAAK,WAAU;;0DACd,8OAAC,6MAAK;gDAAC,WAAU;;;;;;4CAAY;;;;;;;oCAIhC,SAAS,iBAAiB,kBACzB,8OAAC;wCAAK,WAAU;kDAA0D;;;;;;oCAI3E,sBAAsB,mBACrB,8OAAC;wCAAK,WAAU;kDAA0D;;;;;;;;;;;;0CAK9E,8OAAC;gCAAE,WAAU;0CAA8B,SAAS,OAAO;;;;;;4BAC1D,SAAS,aAAa,GAAG,mBACxB,8OAAC;gCAAI,WAAU;;kDACb,8OAAC;;4CAAK;4CAAI,SAAS,aAAa;4CAAC;;;;;;;kDACjC,8OAAC;;4CAAK;4CAAI,SAAS,WAAW;4CAAC;;;;;;;kDAC/B,8OAAC;;4CAAK;4CAAM;4CAAmB;;;;;;;;;;;;;;;;;;;oBAMpC,SAAS,4BACR,8OAAC,qIAAM;wBACL,MAAK;wBACL,WAAU;wBACV,SAAS,CAAC;4BACR,EAAE,eAAe;4BACjB;wBACF;;0CAEA,8OAAC,0MAAI;gCAAC,WAAU;;;;;;4BAAiB;;;;;;;oBAMpC,SAAS,YAAY,CAAC,+BACrB,8OAAC;wBAAI,WAAU;;0CACb,8OAAC,qIAAM;gCACL,SAAQ;gCACR,MAAK;gCACL,WAAU;gCACV,SAAS,CAAC;oCACR,EAAE,eAAe;oCACjB,YAAY,CAAC;gCACf;0CAEA,cAAA,8OAAC,0OAAY;oCAAC,WAAU;;;;;;;;;;;4BAGzB,0BACC;;kDACE,8OAAC;wCACC,WAAU;wCACV,SAAS,IAAM,YAAY;;;;;;kDAE7B,8OAAC;wCAAI,WAAU;;0DACb,8OAAC;gDACC,WAAU;gDACV,SAAS,CAAC;oDACR,EAAE,eAAe;oDACjB,YAAY;oDACZ;gDACF;;kEAEA,8OAAC,gNAAM;wDAAC,WAAU;;;;;;oDAAiB;;;;;;;0DAGrC,8OAAC;gDACC,WAAU;gDACV,SAAS,CAAC;oDACR,EAAE,eAAe;oDACjB,YAAY;oDACZ;gDACF;;kEAEA,8OAAC,oNAAM;wDAAC,WAAU;;;;;;oDAAiB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAYzD"}}]
}